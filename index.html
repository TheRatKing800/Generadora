<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Atenea ‚Äî prototipo</title>
  <style>
    :root { --pad:16px; --radius:16px; }
    * { box-sizing: border-box; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin:0; background:#0f172a; color:#e5e7eb;}
    header { padding:24px var(--pad); background:#111827; border-bottom:1px solid #1f2937;}
    h1 { margin:0 0 6px; font-size:24px; font-weight:500;}
    .sub { color:#9ca3af; font-size:18px;}
    main { max-width:900px; margin: 0 auto; padding: 24px var(--pad) 80px;}
    .card { background:#111827; border:1px solid #1f2937; border-radius:var(--radius); padding: 18px; box-shadow:0 10px 25px rgba(0,0,0,.25);}
    .row { display:grid; gap:12px; }
    @media (min-width: 720px){ .row-3 { grid-template-columns: repeat(3, 1fr);} .row-2 { grid-template-columns: repeat(2, 1fr);} }
    label { font-size:18px; color:#cbd5e1; }
    select, input[type="number"], button, .pill {
      width:100%; background:#0b1220; color:#e5e7eb; border:1px solid #1f2937;
      padding:10px 12px; border-radius:12px; outline:none;
    }
    button { cursor:pointer; font-weight:400; }
    button.primary { background:#2563eb; border-color:#2563eb; }
    button.ghost { background:#0b1220; }
    button:disabled { opacity:.6; cursor:not-allowed; }
    .prompt { font-size:24px; line-height:1.5; margin: 8px 0 14px; color:#f3f4f6;}
    .opts { display:grid; gap:10px; }
    .opt { font-size:22px;  text-align:left; padding:12px; border-radius:12px; border:1px solid #1f2937; background:#0b1220; cursor:pointer; }
    .opt.correct { border-color:#16a34a; background:#0b1f14; }
    .opt.wrong   { border-color:#dc2626; background:#1a0b0b; }
    .muted { color:#9ca3af; font-size:15px; }
    .badge { display:inline-block; padding:4px 8px; border-radius:999px; background:#0b1220; border:1px solid #1f2937; color:#cbd5e1; font-size:14px; }
    .spacer { height:8px; }
    .footer { position:fixed; left:0; right:0; bottom:0; padding:10px var(--pad); background:#0b1220; border-top:1px solid #1f2937; display:flex; gap:10px; align-items:center; justify-content:space-between;}
    .score { font-weight:500; }
    .explain { margin-top:10px; color:#d1d5db; font-size:18px; }
    .hide { display:none; }
    .selected {
      border-color:#2563eb;
      background:#1e3a8a;
    }
  </style>
</head>
<body>

<main>
  <section id="panel-config" class="card">
    

  
  <!-- üîπ PASO 1: CURSO ACAD√âMICO -->
  <div class="row row-2">
    <div>
      <label for="curso">Curso acad√©mico</label>
      <select id="curso">
        <option value="">-- Selecciona curso --</option>
        <option value="Promocion_XXXIV_STP">Promoci√≥n XXXIV STP</option>
        <option value="Promocion_XXXV_STP">Promoci√≥n XXXV STP</option>
        <option value="Promocion_XXXVI_STP">Promoci√≥n XXXVI STP</option>
      </select>
    </div>
  </div>
  <div class="spacer"></div>
<!-- üîπ NUEVO BLOQUE DE SELECCI√ìN EN CASCADA -->
  <div class="row row-3" id="fila-eat">
  <div id="bloque-esp">
    <label for="especialidad">Especialidad</label>
    <select id="especialidad">
      <option value="">-- Selecciona especialidad --</option>
      <option value="GENERAL">GENERAL</option>
      <option value="CAE">CAE</option>
      <option value="CYB">CYB</option>
      <option value="MER">MER</option>
      <option value="ELC">ELC</option>
      <option value="AYF">AYF</option>
      <option value="PAO">PAO</option>
    </select>
  </div>
  <div id="bloque-asig">
    <label for="asignatura">Asignatura</label>
    <select id="asignatura" disabled>
      <option value="">-- Selecciona asignatura --</option>
    </select>
  </div>
  <div id="bloque-tema">
    <label for="tema">Tema</label>
    <select id="tema" disabled>
      <option value="">-- Selecciona tema --</option>
    </select>
  </div>
</div>

  <div class="spacer"></div>
  <!-- üîπ FIN DEL BLOQUE NUEVO -->
    <div class="row row-1">
  <div>
    <label for="modo">Modo de juego</label>
    <select id="modo">
  <option value="">-- Selecciona modo de juego --</option>
  <option value="estandar">Est√°ndar (30 preguntas, revisi√≥n final)</option>
  <option value="contrarreloj">Contrarreloj (vidas + tiempo)</option>
  <option value="vidas">Por vidas (explicaciones + vidas)</option>
</select>

  </div>
</div>

  <div class="spacer"></div>
  <!-- üîπ PASO FINAL: MODELO -->
  <div class="spacer"></div>
  <div class="row row-1">
    <div>
      <label for="modelo">Modelo</label>
      <select id="modelo">
        <option value="">-- Selecciona --</option>
        <option value="A">Modelo A ‚Äî Daypo</option>
        <option value="B">Modelo B ‚Äî Libro</option>
        <option value="C">Modelo C ‚Äî Diario de la gente</option>
        <option value="D">Modelo D ‚Äî Todo</option>
        <option value="E">Modelo E ‚Äî Selecci√≥n por grupos</option>
      </select>
    </div>
  </div>
  <div class="spacer"></div>
  <div id="opcionesModelo" class="card hide"></div>
  <div class="spacer"></div>

  <div class="row row-2">
    <button id="start" class="primary" disabled>Empezar</button>
  </div>

  </section> <!-- üî∏ CIERRE correcto de #panel-config -->

<section id="panel-test" class="card hide">
  <div class="muted" id="meta"></div>
  <div class="prompt" id="prompt"></div>
  <div id="options" class="opts"></div>
  <div id="explain" class="explain hide"></div>
</section>

<section id="panel-result" class="card hide">
  <h3>Resumen</h3>
  <p class="muted" id="summary"></p>
  <div class="spacer"></div>
  <div class="row row-2">
    <button id="retry" class="primary">Repetir con mismos ajustes</button>
    <button id="home" class="ghost">Volver al inicio</button>
  </div>
</section>

</main>

<footer class="footer">
  <div style="display:flex; gap:12px; align-items:center;">
    <span class="badge" id="modeBadge">‚Äî</span>
    <span id="lives" class="muted"></span>
    <span id="timer" class="muted"></span>
  </div>
  <div class="score" id="score">0 / 0</div>
  <div style="display:flex; gap:8px;">
    <button id="check" class="ghost">Comprobar</button>
    <button id="next" class="primary" disabled>Siguiente</button>
  </div>
</footer>


<script>
/* ==========================================================
   SUPERTEST ‚Äî MOTOR B√ÅSICO LIMPIO
========================================================== */

const rndInt = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;
const shuffle = (arr) => arr.map(v => [Math.random(), v]).sort((a,b)=>a[0]-b[0]).map(x=>x[1]);

const REGISTRY = { types: {} };

/* ========== TIPO: CONSTITUCI√ìN (ejemplo) ========== */
// constitucion.js - TODAS LAS PLANTILLAS TRADUCIDAS DESDE Constitucion_prime.py

(function registerAritmetica(){
  function suma_basica(){
    const a = rndInt(1,1000);
    const b = rndInt(1,1000);
    const correct = a + b;

    function generarDistractores(correct){
      const distractores = new Set();
      while (distractores.size < 3){
        let delta;
        if (Math.random() < 0.8){
          delta = rndInt(-9,9);
          if (delta === 0) continue;
        } else {
          delta = Math.random() < 0.5 ? -10 : 10;
        }
        const valor = correct + delta;
        if (valor !== correct && !distractores.has(valor)){
          distractores.add(valor);
        }
      }
      return Array.from(distractores);
    }

    const distractores = generarDistractores(correct);
    const options = shuffle([correct, ...distractores]);

    return {
      tema: "Aritm√©tica",
      modelos: ["B","D"],
      repeatable: true,
      mode:"single",
      prompt:`¬øCu√°nto es ${a} + ${b}?`,
      options: options.map(String),
      correct:[options.indexOf(correct)]
    };
  }

  function multiplicacion_basica(){
    let a, b;
    const tipo = rndInt(1,3);
    if (tipo === 1){
      a = rndInt(1,9);
      b = rndInt(1,9);
    } else if (tipo === 2){
      if (Math.random() < 0.5){
        a = rndInt(1,9);
        b = rndInt(10,99);
      } else {
        a = rndInt(10,99);
        b = rndInt(1,9);
      }
    } else {
      a = rndInt(10,99);
      b = rndInt(10,99);
    }

    const correct = a * b;

    function generarDistractores(correct){
      const distractores = new Set();
      while (distractores.size < 3){
        let delta;
        if (Math.random() < 0.8){
          delta = rndInt(-9,9);
          if (delta === 0) continue;
        } else {
          delta = Math.random() < 0.5 ? -10 : 10;
        }
        const valor = correct + delta;
        if (valor !== correct && !distractores.has(valor)){
          distractores.add(valor);
        }
      }
      return Array.from(distractores);
    }

    const distractores = generarDistractores(correct);
    const options = shuffle([correct, ...distractores]);

    return {
      tema: "Aritm√©tica",
      modelos: ["B","D"],
      repeatable: true,
      mode:"single",
      prompt:`¬øCu√°nto es ${a} √ó ${b}?`,
      options: options.map(String),
      correct:[options.indexOf(correct)]
    };
  }

  function resta_basica(){
    const a = rndInt(1,1000);
    const b = rndInt(1,1000);
    const correct = a - b;

    function generarDistractores(correct){
      const distractores = new Set();
      while (distractores.size < 3){
        let delta;
        if (Math.random() < 0.8){
          delta = rndInt(-9,9);
          if (delta === 0) continue;
        } else {
          delta = Math.random() < 0.5 ? -10 : 10;
        }
        const valor = correct + delta;
        if (valor !== correct && !distractores.has(valor)){
          distractores.add(valor);
        }
      }
      return Array.from(distractores);
    }

    const distractores = generarDistractores(correct);
    const options = shuffle([correct, ...distractores]);

    return {
      tema: "Aritm√©tica",
      modelos: ["B","D"],
      repeatable: true,
      mode:"single",
      prompt:`¬øCu√°nto es ${a} - ${b}?`,
      options: options.map(String),
      correct:[options.indexOf(correct)]
    };
  }

  REGISTRY.types["matematicas_aritmetica"] = {
    name: "Aritm√©tica",
    templates: [suma_basica, resta_basica, multiplicacion_basica]
  };
})();
REGISTRY.types['teoria_electrones'] = { name: 'Teor√≠a de los electrones', templates: [configuracion_electronica,pregunta_teoria_de_los_electrones_1,pregunta_teoria_de_los_electrones_2,pregunta_teoria_de_los_electrones_3,pregunta_teoria_de_los_electrones_4,pregunta_teoria_de_los_electrones_5,pregunta_teoria_de_los_electrones_6,pregunta_teoria_de_los_electrones_7,pregunta_teoria_de_los_electrones_8,pregunta_teoria_de_los_electrones_9,pregunta_teoria_de_los_electrones_10,pregunta_teoria_de_los_electrones_11,pregunta_teoria_de_los_electrones_12,pregunta_teoria_de_los_electrones_13,pregunta_teoria_de_los_electrones_14,pregunta_teoria_de_los_electrones_15,pregunta_teoria_de_los_electrones_16,pregunta_teoria_de_los_electrones_17,pregunta_teoria_de_los_electrones_18,pregunta_teoria_de_los_electrones_19,pregunta_teoria_de_los_electrones_20,pregunta_teoria_de_los_electrones_21,pregunta_teoria_de_los_electrones_22,pregunta_teoria_de_los_electrones_23,pregunta_teoria_de_los_electrones_24,pregunta_teoria_de_los_electrones_25]};

(function registerEOFAS(){
  function eofas_1(){
  return {
    tema: "EOFAS",
    modelos: ["A","D"],
    repeatable: false,
    mode: "single",
    prompt: "A la Direcci√≥n General de Pol√≠tica de Defensa le corresponde:",
    options: [
      "Elaborar las lineas generales de las directrices generales de pol√≠tica de defensa para la participaci√≥n de otros Departamentos Ministeriales en la Defensa nacional",
      "Ejercer la notar√≠a militar",
      "Establecer la aplicaci√≥n de los planes de calidad de vida del personal militar.",
      "Gestionar la ordenaci√≥n farmac√©utica"
    ],
    correct: [0] // ‚ö†Ô∏è Marcar luego la correcta manualmente
  };
}


function eofas_2(){
  const base = [
    "El CIFAS est√° integrado en el EMACOM",
    "El MOPS est√° integrado en el Cuartel General del EMAD",
    "El EMACON es el √≥rgano auxiliar de mando del JEMAD",
    "__META__" // se convertir√° en "A y C son correctas."
  ];

  const barajadas = shuffle(base);
  const idxMeta = barajadas.indexOf("__META__");

  const letra = (i) => String.fromCharCode(97 + i);

  // Localizar √≠ndices de las opciones que la meta debe referenciar
  const idxCIFAS = barajadas.indexOf("El CIFAS est√° integrado en el EMACOM");
  const idxEMACON = barajadas.indexOf("El EMACON es el √≥rgano auxiliar de mando del JEMAD");

  // Reescribir la opci√≥n meta con las letras reales
  barajadas[idxMeta] = `${letra(idxCIFAS)}) y ${letra(idxEMACON)}) son correctas.`;

  return {
    tema: "EOFAS",
    modelos: ["A","D"],
    repeatable: false,
    mode: "single",
    prompt: "Marcar la respuesta correcta",
    options: barajadas,
    correct: [2] // ‚ö†Ô∏è c√°mbialo seg√∫n cu√°l/es la correcta
  };
}



function eofas_3(){
  return {
    tema: "EOFAS",
    modelos: ["A","D"],
    repeatable: false,
    mode: "single",
    prompt: "Como √≥rgano de asesoramiento y asistencia inmediata, el Ministro de Defensa cuenta con:",
    options: [
      "La Direcci√≥n General de Pol√≠tica de Defensa",
      "La Oficina de Comunicaci√≥n de la Defensa",
      "El Consejo Superior de los Ej√©rcitos.",
      "Un Gabinete T√©cnico"
    ],
    correct: [3] // ‚ö†Ô∏è Marcar luego la correcta manualmente
  };
}


function eofas_4(){
  const base = [
    "Dirigir el Plan de Diplomacia de Defensa",
    "Elaborar y proponer disposiciones en materia de retribuciones militares",
    "__META__", // se convertir√° en "a) y b) son correctas."
    "El asesoramiento sobre los aspectos relacionados con el estudio, planeamiento y desarrollo de las actividades de las Fuerzas Armadas"
  ];

  const barajadas = shuffle(base);
  const idxMeta = barajadas.indexOf("__META__");

  const letra = (i) => String.fromCharCode(97 + i);

  // Localizar los √≠ndices de las dos opciones que la meta debe referenciar
  const idxDiplomacia = barajadas.indexOf("Dirigir el Plan de Diplomacia de Defensa");
  const idxRetribuciones = barajadas.indexOf("Elaborar y proponer disposiciones en materia de retribuciones militares");

  // Reescribir la opci√≥n meta con las letras reales
  barajadas[idxMeta] = `${letra(idxDiplomacia)}) y ${letra(idxRetribuciones)}) son correctas.`;

  return {
    tema: "EOFAS",
    modelos: ["A","D"],
    repeatable: false,
    mode: "single",
    prompt: "A la Secretar√≠a General de Pol√≠tica de Defensa le corresponde:",
    options: barajadas,
    correct: [0] // ‚ö†Ô∏è c√°mbialo seg√∫n cu√°l/es la correcta
  };
}



function eofas_5(){
  return {
    tema: "EOFAS",
    modelos: ["A","D"],
    repeatable: false,
    mode: "single",
    prompt: "El √≥rgano encargado de dirigir la elaboraci√≥n de los tratados internacionales que afecten a la Defensa es:",
    options: [
      "La SEDEF",
      "La DIGENPER",
      "La SUBDEF.",
      "La Secretar√≠a General de Pol√≠tica de Defensa"
    ],
    correct: [3] // ‚ö†Ô∏è Marcar luego la correcta manualmente
  };
}


function eofas_6(){
  return {
    tema: "EOFAS",
    modelos: ["A","D"],
    repeatable: false,
    mode: "single",
    prompt: "Al Jefe de Estado Mayor de la Defensa le corresponde:",
    options: [
      "Garantizar la seguridad criptogr√°fica",
      "La funci√≥n de asesoramiento militar al Presidente del Gobierno",
      "Coordinar el Plan General de la Defensa Nacional.",
      "Asesorar al Secretario de Estado de Defensa en el desarrollo de la pol√≠tica econ√≥mica de sus ej√©rcitos"
    ],
    correct: [1] // ‚ö†Ô∏è Marcar luego la correcta manualmente
  };
}


function eofas_7(){
  return {
    tema: "EOFAS",
    modelos: ["A","D"],
    repeatable: false,
    mode: "single",
    prompt: "El √≥rgano auxiliar de mando del JEMAD que apoya y asesora en la definici√≥n de la estrategia militares:",
    options: [
      "El EMACON",
      "La SUBDEF",
      "La SEDEF.",
      "El EMACOM"
    ],
    correct: [0] // ‚ö†Ô∏è Marcar luego la correcta manualmente
  };
}


function eofas_8(){
  const base = [
    "Dirigir la pol√≠tica de armamento, en relaci√≥n con organismos internacionales",
    "Asegurar la eficacia operativa de las Fuerzas Armadas",
    "__META__", // se convertir√° en "a) y c) son correctas."
    "Ejercer bajo la dependencia del Presidente del Gobierno el mando de la estructura operativa de las Fuerzas Armadas"
  ];

  const barajadas = shuffle(base);
  const idxMeta = barajadas.indexOf("__META__");

  const letra = (i) => String.fromCharCode(97 + i);

  // Localizar las dos opciones que debe referenciar la meta
  const idxArmamento = barajadas.indexOf("Dirigir la pol√≠tica de armamento, en relaci√≥n con organismos internacionales");
  const idxEjercer = barajadas.indexOf("Ejercer bajo la dependencia del Presidente del Gobierno el mando de la estructura operativa de las Fuerzas Armadas");

  // Reescribir el texto meta con las letras reales
  barajadas[idxMeta] = `${letra(idxArmamento)}) y ${letra(idxEjercer)}) son correctas.`;

  return {
    tema: "EOFAS",
    modelos: ["A","D"],
    repeatable: false,
    mode: "single",
    prompt: "Al Jefe de Estado Mayor de la Defensa le corresponde:",
    options: barajadas,
    correct: [1] // ‚ö†Ô∏è cambia este √≠ndice seg√∫n cu√°l/es sean correctas
  };
}



function eofas_9(){
  return {
    tema: "EOFAS",
    modelos: ["A","D"],
    repeatable: false,
    mode: "single",
    prompt: "El √≥rgano encargado de realizar las expropiaciones de bienes y derechos as√≠ como los arrendamientos pertinentes es:",
    options: [
      "La DIGENIN",
      "La DGAM",
      "La DIGENPER.",
      "La DIGENECO"
    ],
    correct: [0] // ‚ö†Ô∏è Marcar luego la correcta manualmente
  };
}


function eofas_10(){
  const base = [
    "Es un mando conjunto de la estructura operativa constituido de forma permanente",
    "Tiene como misi√≥n la intervenci√≥n en cualquier lugar del territorio nacional exclusivamente",
    "__META__", // se convertir√° en "b) y c) son correctas."
    "El JEMAD dictar√° las normas que regulen su organizaci√≥n"
  ];

  const barajadas = shuffle(base);
  const idxMeta = barajadas.indexOf("__META__");

  const letra = (i) => String.fromCharCode(97 + i);

  // Localizar los √≠ndices de las dos opciones que la meta debe se√±alar
  const idxMision = barajadas.indexOf("Tiene como misi√≥n la intervenci√≥n en cualquier lugar del territorio nacional exclusivamente");
  const idxJEMAD = barajadas.indexOf("El JEMAD dictar√° las normas que regulen su organizaci√≥n");

  // Reescribir el texto meta con las letras actuales
  barajadas[idxMeta] = `${letra(idxMision)}) y ${letra(idxJEMAD)}) son correctas.`;

  return {
    tema: "EOFAS",
    modelos: ["A","D"],
    repeatable: false,
    mode: "single",
    prompt: "La UME:",
    options: barajadas,
    correct: [0] // ‚ö†Ô∏è c√°mbialo seg√∫n cu√°l/es sean las correctas
  };
}



function eofas_11(){
  const base = [
    "Desarrollar la pol√≠tica medioambiental del Departamento",
    "Administrar los recursos financieros destinados a las operaciones de paz",
    "__META__", // se convertir√° en "a) y c) son correctas."
    "Dirigir la gesti√≥n de los bienes afectos al Ministerio de Defensa"
  ];

  const barajadas = shuffle(base);
  const idxMeta = barajadas.indexOf("__META__");

  const letra = (i) => String.fromCharCode(97 + i);

  // Localizar los √≠ndices de las dos opciones que debe se√±alar la meta
  const idxMedioambiente = barajadas.indexOf("Desarrollar la pol√≠tica medioambiental del Departamento");
  const idxBienes = barajadas.indexOf("Dirigir la gesti√≥n de los bienes afectos al Ministerio de Defensa");

  // Reescribir el texto meta con las letras actuales
  barajadas[idxMeta] = `${letra(idxMedioambiente)}) y ${letra(idxBienes)}) son correctas.`;

  return {
    tema: "EOFAS",
    modelos: ["A","D"],
    repeatable: false,
    mode: "single",
    prompt: "A la DIGENECO le corresponde:",
    options: barajadas,
    correct: [1] // ‚ö†Ô∏è c√°mbialo seg√∫n cu√°l/es sean correctas
  };
}



function eofas_12(){
  return {
    tema: "EOFAS",
    modelos: ["A","D"],
    repeatable: false,
    mode: "single",
    prompt: "El √≥rgano encargado de llevar el inventario de los bienes del Ministerio de Defensa es:",
    options: [
      "La Secretar√≠a de Estado de Defensa",
      "La Direcci√≥n General de Infraestructura",
      "La Subdirecci√≥n General de R√©gimen Interior.",
      "La Direcci√≥n General de Patrimonio e Inventario"
    ],
    correct: [1] // ‚ö†Ô∏è Marcar luego la correcta manualmente
  };
}


function eofas_13(){
  return {
    tema: "EOFAS",
    modelos: ["A","D"],
    repeatable: false,
    mode: "single",
    prompt: "El √≥rgano encargado de gestionar los sistemas inform√°ticos integrales de direcci√≥n y administraci√≥n econ√≥mica del Departamento es:",
    options: [
      "La Subdirecci√≥n General de Servicios Econ√≥micos y Pagadur√≠as",
      "La SEGENTE",
      "DIGENECO.",
      "DIGENIN"
    ],
    correct: [2] // ‚ö†Ô∏è Marcar luego la correcta manualmente
  };
}


function eofas_14(){
  return {
    tema: "EOFAS",
    modelos: ["A","D"],
    repeatable: false,
    mode: "single",
    prompt: "El √≥rgano encargado de la direcci√≥n de las tecnolog√≠as y seguridad de la informaci√≥n en el √°mbito de la defensa es:",
    options: [
      "El Presidente del Gobierno",
      "La Junta de Defensa Nacional",
      "La SEDEF.",
      "El JEMAD"
    ],
    correct: [2] // ‚ö†Ô∏è Marcar luego la correcta manualmente
  };
}


function eofas_15(){
  return {
    tema: "EOFAS",
    modelos: ["A","D"],
    repeatable: false,
    mode: "single",
    prompt: "El √≥rgano encargado de proponer la pol√≠tica industrial de la defensa es:",
    options: [
      "La SUBDEF",
      "La DIGENECO",
      "La DGAM",
      "La DGAN"
    ],
    correct: [2] // ‚ö†Ô∏è Marcar luego la correcta manualmente
  };
}


function eofas_16(){
  return {
    tema: "EOFAS",
    modelos: ["A","D"],
    repeatable: false,
    mode: "single",
    prompt: "El √≥rgano encargado de la gesti√≥n de los servicios generales del √≥rgano central es:",
    options: [
      "La Secretar√≠a General T√©cnica",
      "La Subdirecci√≥n General de R√©gimen Interior",
      "La Subdirecci√≥n General de Seguridad y Servicios.",
      "La Subdirecci√≥n General de Servicios"
    ],
    correct: [1] // ‚ö†Ô∏è Marcar luego la correcta manualmente
  };
}


function eofas_17(){
  return {
    tema: "EOFAS",
    modelos: ["A","D"],
    repeatable: false,
    mode: "single",
    prompt: "El √≥rgano encargado de elaborar estudios e informes sobre cu√°ntos asuntos sean sometidos a la deliberaci√≥n del Consejo de Ministros es:",
    options: [
      "La SEGENTE",
      "La Direcci√≥n General de Sanidad",
      "La Asesor√≠a Jur√≠dica General.",
      "La DIGENPER"
    ],
    correct: [0] // ‚ö†Ô∏è Marcar luego la correcta manualmente
  };
}


function eofas_18(){
  return {
    tema: "EOFAS",
    modelos: ["A","D"],
    repeatable: false,
    mode: "single",
    prompt: "El √≥rgano encargado del registro general en el √≥rgano central en el Ministerio de Defensa es:",
    options: [
      "La Subdirecci√≥n General de R√©gimen Interior",
      "La SEGENTE",
      "La Subdirecci√≥n General de Registro y Archivos.",
      "La SUBDEF"
    ],
    correct: [0] // ‚ö†Ô∏è Marcar luego la correcta manualmente
  };
}


function eofas_19(){
  const base = [
    "Elaborar el BOD",
    "Coordinar la pol√≠tica de igualdad",
    "__META__", // se convertir√° en "a) y c) son correctas."
    "Proponer y elaborar normas sobre reformas de m√©todos de trabajo"
  ];

  const barajadas = shuffle(base);
  const idxMeta = barajadas.indexOf("__META__");

  const letra = (i) => String.fromCharCode(97 + i);

  // Localizar √≠ndices de las opciones que la meta debe referenciar
  const idxBOD = barajadas.indexOf("Elaborar el BOD");
  const idxNormas = barajadas.indexOf("Proponer y elaborar normas sobre reformas de m√©todos de trabajo");

  // Reescribir la opci√≥n meta con las letras reales
  barajadas[idxMeta] = `${letra(idxBOD)}) y ${letra(idxNormas)}) son correctas.`;

  return {
    tema: "EOFAS",
    modelos: ["A","D"],
    repeatable: false,
    mode: "single",
    prompt: "A la DIGENPER le corresponde:",
    options: barajadas,
    correct: [1] // ‚ö†Ô∏è c√°mbialo seg√∫n cu√°l/es la correcta
  };
}


function eofas_20(){
  return {
    tema: "EOFAS",
    modelos: ["A","D"],
    repeatable: false,
    mode: "single",
    prompt: "A la SEGENTE le corresponde:",
    options: [
      "Gestionar el personal militar de los Cuerpos Comunes",
      "Coordinar la pol√≠tica social para el personal militar",
      "Atender al gobierno de los √≥rganos centrales del Ministerio.",
      "Coordinar, gestionar e inspeccionar las Delegaciones de Defensa"
    ],
    correct: [3] // ‚ö†Ô∏è Marcar luego la correcta manualmente
  };
}


function eofas_21(){
  return {
    tema: "EOFAS",
    modelos: ["A","D"],
    repeatable: false,
    mode: "single",
    prompt: "Marcar la respuesta incorrecta:",
    options: [
      "El Ej√©rcito de Tierra est√° constituido por el Cuartel General, la Fuerza y el Apoyo a la Fuerza",
      "A la DIGENPER le corresponde elaborar el r√©gimen general de los centros docentes militares, del alumnado y del profesorado",
      "A la DIGENPER le corresponde reconocer los derechos pasivos y conceder las prestaciones de clases pasivas del personal militar.",
      "A la DIGENPER le corresponde planificar los efectivos y el reclutamiento del personal militar"
    ],
    correct: [1] // ‚ö†Ô∏è Marcar luego la correcta manualmente
  };
}


function eofas_22(){
  return {
    tema: "EOFAS",
    modelos: ["A","D"],
    repeatable: false,
    mode: "single",
    prompt: "El √≥rgano encargado de gestionar la formaci√≥n para el personal civil es:",
    options: [
      "La DIGENPER",
      "La DIGEREM",
      "La Subdirecci√≥n General de R√©gimen Interior.",
      "La SEGENTE"
    ],
    correct: [0] // ‚ö†Ô∏è Marcar luego la correcta manualmente
  };
}


function eofas_23(){
  return {
    tema: "EOFAS",
    modelos: ["A","D"],
    repeatable: false,
    mode: "single",
    prompt: "El √≥rgano encargado de elaborar los planes de salidas profesionales del personal de las FAS es:",
    options: [
      "La DIGENPER",
      "La Direcci√≥n General de Pol√≠tica de Defensa",
      "La DIGEREN.",
      "La DIGEREM"
    ],
    correct: [3] // ‚ö†Ô∏è Marcar luego la correcta manualmente
  };
}


function eofas_24(){
  return {
    tema: "EOFAS",
    modelos: ["A","D"],
    repeatable: false,
    mode: "single",
    prompt: "El cargo de Inspector General de Sanidad ser√° desempe√±ado por:",
    options: [
      "Un General de Brigada del Cuerpo Militar de Sanidad",
      "Un Oficial General de los Cuerpos Comunes",
      "Un General de Divisi√≥n del Cuerpo Militar de Sanidad, en situaci√≥n de servicio activo.",
      "Un General de Divisi√≥n de cualquiera de los Ej√©rcitos"
    ],
    correct: [2] // ‚ö†Ô∏è Marcar luego la correcta manualmente
  };
}


function eofas_25(){
  return {
    tema: "EOFAS",
    modelos: ["A","D"],
    repeatable: false,
    mode: "single",
    prompt: "El Ej√©rcito de Tierra, la Armada y el Ej√©rcito del Aire est√°n constituidos por:",
    options: [
      "El Cuartel General, la Log√≠stica y el Apoyo a la Fuerza",
      "La Fuerza, el Apoyo a la Fuerza y el Cuartel General",
      "El Apoyo a la Fuerza, el Cuartel General y las Fuerzas Operativas.",
      "La Fuerza, la Log√≠stica y el Mando Supremo"
    ],
    correct: [1] // ‚ö†Ô∏è Marcar luego la correcta manualmente
  };
}


function eofas_26(){
  return {
    tema: "EOFAS",
    modelos: ["A","D"],
    repeatable: false,
    mode: "single",
    prompt: "El Consejo Superior del Ej√©rcito del Aire es el √≥rgano colegiado asesor y consultivo de:",
    options: [
      "El Presidente del Gobierno",
      "El Subsecretario de Defensa",
      "La Junta de Defensa Nacional.",
      "El Ministro de Defensa"
    ],
    correct: [3] // ‚ö†Ô∏è Marcar luego la correcta manualmente
  };
}


function eofas_27(){
  return {
    tema: "EOFAS",
    modelos: ["A","D"],
    repeatable: false,
    mode: "single",
    prompt: "El cargo de Secretario del CSEA ser√° ejercido por:",
    options: [
      "El Vocal Accidental que se designe",
      "No existe el cargo de Secretario en el Consejo",
      "El Oficial General titular de la Secretar√≠a Permanente del CSEA.",
      "El Vocal de mayor antig√ºedad"
    ],
    correct: [2] // ‚ö†Ô∏è Marcar luego la correcta manualmente
  };
}


function eofas_28(){
  return {
    tema: "EOFAS",
    modelos: ["A","D"],
    repeatable: false,
    mode: "single",
    prompt: "Al General Jefe del MACOM en el Consejo le corresponder√° ser:",
    options: [
      "Vocal Accidental",
      "Vocal asesor",
      "Depende del tipo de reuni√≥n a realizar.",
      "Vocal Nato"
    ],
    correct: [3] // ‚ö†Ô∏è Marcar luego la correcta manualmente
  };
}


function eofas_29(){
  return {
    tema: "EOFAS",
    modelos: ["A","D"],
    repeatable: false,
    mode: "single",
    prompt: "Al Consejo Superior del Ej√©rcito del Aire le corresponde:",
    options: [
      "Emitir informe sobre aquellos asuntos que someta a su consideraci√≥n el JEMA",
      "Ser o√≠do por el Ministro de Defensa en relaci√≥n con su propuesta de designaci√≥n del Jefe de Estado Mayor del Aire",
      "Todas las anteriores son correctas.",
      "Asesorar al Ministro de Defensa en materias relativas a la estructuraci√≥n del E.A"
    ],
    correct: [2] // ‚ö†Ô∏è Marcar luego la correcta manualmente
  };
}


function eofas_30(){
  return {
    tema: "EOFAS",
    modelos: ["A","D"],
    repeatable: false,
    mode: "single",
    prompt: "Las reuniones del Consejo Superior del Ej√©rcito del Aire ser√°n convocadas por:",
    options: [
      "El Ministro de Defensa",
      "El Presidente del Gobierno",
      "El Director de Pol√≠tica de Defensa.",
      "El Jefe de Estado Mayor de la Defensa"
    ],
    correct: [0] // ‚ö†Ô∏è Marcar luego la correcta manualmente
  };
}


function eofas_31(){
  return {
    tema: "EOFAS",
    modelos: ["A","D"],
    repeatable: false,
    mode: "single",
    prompt: "Es funci√≥n del CSEA:",
    options: [
      "Informar las evaluaciones para el ascenso al empleo de Teniente de los Militares de Complemento",
      "Ser o√≠do por el Ministro de Defensa en relaci√≥n con su propuesta de designaci√≥n del JEMAD",
      "Todas las anteriores son ciertas.",
      "Emitir informe en aquellos asuntos que someta a su consideraci√≥n expresa el JEMA"
    ],
    correct: [3] // ‚ö†Ô∏è Marcar luego la correcta manualmente
  };
}


function eofas_32(){
  return {
    tema: "EOFAS",
    modelos: ["A","D"],
    repeatable: false,
    mode: "single",
    prompt: "¬øA que √≥rgano le corresponde impartir los Altos Estudios de la Defensa Nacional?",
    options: [
      "Centro Superior de Altos Estudios de la Defensa(CESADEF)",
      "Centro Superior de Estudios de la Defensa Institucional(CESEDIN)",
      "Centro Superior de Estudios de la Defensa Nacional(CEDEDEN)",
      "Centro Universitario de la Defensa (CUD)."
    ],
    correct: [1] // ‚ö†Ô∏è Marcar luego la correcta manualmente
  };
}


function eofas_33(){
  return {
    tema: "EOFAS",
    modelos: ["A","D"],
    repeatable: false,
    mode: "single",
    prompt: "El organismo p√∫blico dependiente directamente del titular del Departamento, y responsable de facilitar las informaciones, an√°lisis, estudios o propuestas que permitan prevenir y evitar cualquier peligro, amenaza o agresi√≥n contra la independencia o integridad territorial de Espa√±a, los intereses nacionales y la estabilidad del Estado de derecho y sus instituciones es:",
    options: [
      "Direcci√≥n Institucional de Contrainteligencia de la Defensa",
      "Asesor√≠a de Informaci√≥n y Riesgos del Ministerio de Defensa",
      "Subdirecci√≥n de An√°lisis e Informaci√≥n de la Defensa.",
      "Centro Nacional de Inteligencia"
    ],
    correct: [3] // ‚ö†Ô∏è Marcar luego la correcta manualmente
  };
}

REGISTRY.types["eofas"] = {
    name: "EOFAS",
    templates: [
eofas_1,
eofas_2,
eofas_3,
eofas_4,
eofas_5,
eofas_6,
eofas_7,
eofas_8,
eofas_9,
eofas_10,
eofas_11,
eofas_12,
eofas_13,
eofas_14,
eofas_15,
eofas_16,
eofas_17,
eofas_18,
eofas_19,
eofas_20,
eofas_21,
eofas_22,
eofas_23,
eofas_24,
eofas_25,
eofas_26,
eofas_27,
eofas_28,
eofas_29,
eofas_30,
eofas_31,
eofas_32,
eofas_33

    ]
  };
})();

(function registerConstitucion(){

  function t_constitucion(){
    const anios = [1808,1837,1845,1869,1876];
    const personas = ["Napole√≥n","Mar√≠a Cristina de Borb√≥n","Isabel II","General Francisco Serrano","Alfonso XII"];
    const idx = Math.floor(Math.random()*anios.length);
    const anio = anios[idx], persona = personas[idx];
    const distractores = personas.filter(p=>p!==persona).sort(()=>Math.random()-0.5).slice(0,3);
    const options = [persona,...distractores].sort(()=>Math.random()-0.5);
    return { mode:"single", prompt:`La Constituci√≥n de ${anio} fue entregada por:`, options, correct:[options.indexOf(persona)] };
  }

  
  function t_constitucion_anio(){
    const anios = [1808,1837,1845,1869,1876];
    const personas = ["Napole√≥n","Mar√≠a Cristina de Borb√≥n","Isabel II","General Francisco Serrano","Alfonso XII"];
    const idx = Math.floor(Math.random()*personas.length);
    const persona = personas[idx], anio = anios[idx];
    const distractores = anios.filter(a=>a!==anio).sort(()=>Math.random()-0.5).slice(0,3);
    const options = [anio,...distractores].map(String).sort(()=>Math.random()-0.5);
    return { mode:"single", prompt:`La Constituci√≥n entregada por ${persona} es del a√±o:`, options, correct:[options.indexOf(String(anio))] };
  };

  
  function t_caracteristica(){
    const caracteristicas = {1812:"Soberan√≠a nacional",1837:"Avance liberal",1845:"Moderada",1869:"Democr√°tica"};
    const anios = Object.keys(caracteristicas);
    const idx = Math.floor(Math.random()*anios.length);
    const anio = anios[idx], caracter = caracteristicas[anio];
    const distractores = Object.values(caracteristicas).filter(c=>c!==caracter).sort(()=>Math.random()-0.5).slice(0,3);
    const options = [caracter,...distractores].sort(()=>Math.random()-0.5);
    return { mode:"single", prompt:`Una caracter√≠stica de la Constituci√≥n de ${anio} es:`, options, correct:[options.indexOf(caracter)] };
  };

  
  function t_titulo(){
    const titulos = {1:"De los derechos y deberes",2:"De la Corona",3:"De las Cortes Generales"};
    const num = Object.keys(titulos);
    const idx = Math.floor(Math.random()*num.length);
    const n = num[idx], titulo = titulos[n];
    const distractores = Object.values(titulos).filter(t=>t!==titulo).sort(()=>Math.random()-0.5).slice(0,3);
    const options = [titulo,...distractores].sort(()=>Math.random()-0.5);
    return { mode:"single", prompt:`¬øQu√© regula el T√≠tulo ${n} de la Constituci√≥n?`, options, correct:[options.indexOf(titulo)] };
  };

  function t_no_caract_actual() {
    // TODO: traducir la l√≥gica de inst_pregunta_no_caract_actual desde Python
    return {
      mode: "single",
      prompt: "t_no_caract_actual ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_articulos() {
    // TODO: traducir la l√≥gica de inst_pregunta_articulos desde Python
    return {
      mode: "single",
      prompt: "t_articulos ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_tipo_derecho() {
    // TODO: traducir la l√≥gica de inst_pregunta_tipo_derecho desde Python
    return {
      mode: "single",
      prompt: "t_tipo_derecho ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_deberes() {
    // TODO: traducir la l√≥gica de inst_pregunta_deberes desde Python
    return {
      mode: "single",
      prompt: "t_deberes ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_promulgacion() {
    // TODO: traducir la l√≥gica de inst_pregunta_promulgacion desde Python
    return {
      mode: "single",
      prompt: "t_promulgacion ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_periodo_franquista() {
    // TODO: traducir la l√≥gica de inst_pregunta_periodo_franquista desde Python
    return {
      mode: "single",
      prompt: "t_periodo_franquista ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_pena_muerte() {
    // TODO: traducir la l√≥gica de inst_pregunta_pena_muerte desde Python
    return {
      mode: "single",
      prompt: "t_pena_muerte ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_defender_espana() {
    // TODO: traducir la l√≥gica de inst_pregunta_defender_espana desde Python
    return {
      mode: "single",
      prompt: "t_defender_espana ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_servicio_civil() {
    // TODO: traducir la l√≥gica de inst_pregunta_servicio_civil desde Python
    return {
      mode: "single",
      prompt: "t_servicio_civil ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_estado_excepcion() {
    // TODO: traducir la l√≥gica de inst_pregunta_estado_excepcion desde Python
    return {
      mode: "single",
      prompt: "t_estado_excepcion ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_medioambiente() {
    // TODO: traducir la l√≥gica de inst_pregunta_medioambiente desde Python
    return {
      mode: "single",
      prompt: "t_medioambiente ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_certificacion_medioambiente() {
    // TODO: traducir la l√≥gica de inst_pregunta_certificacion_medioambiente desde Python
    return {
      mode: "single",
      prompt: "t_certificacion_medioambiente ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_sga() {
    // TODO: traducir la l√≥gica de inst_pregunta_sga desde Python
    return {
      mode: "single",
      prompt: "t_sga ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_normativa_medioambiente() {
    // TODO: traducir la l√≥gica de inst_pregunta_normativa_medioambiente desde Python
    return {
      mode: "single",
      prompt: "t_normativa_medioambiente ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_politica_medioambiental() {
    // TODO: traducir la l√≥gica de inst_pregunta_politica_medioambiental desde Python
    return {
      mode: "single",
      prompt: "t_politica_medioambiental ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_funciones_rey() {
    // TODO: traducir la l√≥gica de inst_pregunta_funciones_rey desde Python
    return {
      mode: "single",
      prompt: "t_funciones_rey ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_abdicacion() {
    // TODO: traducir la l√≥gica de inst_pregunta_abdicacion desde Python
    return {
      mode: "single",
      prompt: "t_abdicacion ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_regencia() {
    // TODO: traducir la l√≥gica de inst_pregunta_regencia desde Python
    return {
      mode: "single",
      prompt: "t_regencia ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_tutela() {
    // TODO: traducir la l√≥gica de inst_pregunta_tutela desde Python
    return {
      mode: "single",
      prompt: "t_tutela ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_cortes_poder() {
    // TODO: traducir la l√≥gica de inst_pregunta_cortes_poder desde Python
    return {
      mode: "single",
      prompt: "t_cortes_poder ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_cortes_autonomia() {
    // TODO: traducir la l√≥gica de inst_pregunta_cortes_autonomia desde Python
    return {
      mode: "single",
      prompt: "t_cortes_autonomia ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_cortes_circunscripciones() {
    // TODO: traducir la l√≥gica de inst_pregunta_cortes_circunscripciones desde Python
    return {
      mode: "single",
      prompt: "t_cortes_circunscripciones ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_cortes_mesa() {
    // TODO: traducir la l√≥gica de inst_pregunta_cortes_mesa desde Python
    return {
      mode: "single",
      prompt: "t_cortes_mesa ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_cortes_decretos() {
    // TODO: traducir la l√≥gica de inst_pregunta_cortes_decretos desde Python
    return {
      mode: "single",
      prompt: "t_cortes_decretos ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_gobierno_responsabilidad_penal() {
    // TODO: traducir la l√≥gica de inst_pregunta_gobierno_responsabilidad_penal desde Python
    return {
      mode: "single",
      prompt: "t_gobierno_responsabilidad_penal ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_gobierno_investidura() {
    // TODO: traducir la l√≥gica de inst_pregunta_gobierno_investidura desde Python
    return {
      mode: "single",
      prompt: "t_gobierno_investidura ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_gobierno_vicepresidente() {
    // TODO: traducir la l√≥gica de inst_pregunta_gobierno_vicepresidente desde Python
    return {
      mode: "single",
      prompt: "t_gobierno_vicepresidente ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_gobierno_organo_consultivo() {
    // TODO: traducir la l√≥gica de inst_pregunta_gobierno_organo_consultivo desde Python
    return {
      mode: "single",
      prompt: "t_gobierno_organo_consultivo ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_gobierno_responsabilidad_politica() {
    // TODO: traducir la l√≥gica de inst_pregunta_gobierno_responsabilidad_politica desde Python
    return {
      mode: "single",
      prompt: "t_gobierno_responsabilidad_politica ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_relaciones_responsabilidad() {
    // TODO: traducir la l√≥gica de inst_pregunta_relaciones_responsabilidad desde Python
    return {
      mode: "single",
      prompt: "t_relaciones_responsabilidad ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_relaciones_interpelaciones() {
    // TODO: traducir la l√≥gica de inst_pregunta_relaciones_interpelaciones desde Python
    return {
      mode: "single",
      prompt: "t_relaciones_interpelaciones ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_relaciones_mocion_censura() {
    // TODO: traducir la l√≥gica de inst_pregunta_relaciones_mocion_censura desde Python
    return {
      mode: "single",
      prompt: "t_relaciones_mocion_censura ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_relaciones_cuestion_confianza() {
    // TODO: traducir la l√≥gica de inst_pregunta_relaciones_cuestion_confianza desde Python
    return {
      mode: "single",
      prompt: "t_relaciones_cuestion_confianza ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_relaciones_delegacion() {
    // TODO: traducir la l√≥gica de inst_pregunta_relaciones_delegacion desde Python
    return {
      mode: "single",
      prompt: "t_relaciones_delegacion ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_judicial_independencia() {
    // TODO: traducir la l√≥gica de inst_pregunta_judicial_independencia desde Python
    return {
      mode: "single",
      prompt: "t_judicial_independencia ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_judicial_cgpj() {
    // TODO: traducir la l√≥gica de inst_pregunta_judicial_cgpj desde Python
    return {
      mode: "single",
      prompt: "t_judicial_cgpj ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_judicial_tribunal_supremo() {
    // TODO: traducir la l√≥gica de inst_pregunta_judicial_tribunal_supremo desde Python
    return {
      mode: "single",
      prompt: "t_judicial_tribunal_supremo ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_judicial_ministerio_fiscal() {
    // TODO: traducir la l√≥gica de inst_pregunta_judicial_ministerio_fiscal desde Python
    return {
      mode: "single",
      prompt: "t_judicial_ministerio_fiscal ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_judicial_inalienable() {
    // TODO: traducir la l√≥gica de inst_pregunta_judicial_inalienable desde Python
    return {
      mode: "single",
      prompt: "t_judicial_inalienable ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_economia_potestad() {
    // TODO: traducir la l√≥gica de inst_pregunta_economia_potestad desde Python
    return {
      mode: "single",
      prompt: "t_economia_potestad ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_economia_presupuestos() {
    // TODO: traducir la l√≥gica de inst_pregunta_economia_presupuestos desde Python
    return {
      mode: "single",
      prompt: "t_economia_presupuestos ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_economia_principios() {
    // TODO: traducir la l√≥gica de inst_pregunta_economia_principios desde Python
    return {
      mode: "single",
      prompt: "t_economia_principios ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_economia_tribunal_cuentas() {
    // TODO: traducir la l√≥gica de inst_pregunta_economia_tribunal_cuentas desde Python
    return {
      mode: "single",
      prompt: "t_economia_tribunal_cuentas ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_economia_articulo128() {
    // TODO: traducir la l√≥gica de inst_pregunta_economia_articulo128 desde Python
    return {
      mode: "single",
      prompt: "t_economia_articulo128 ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_territorial_estado() {
    // TODO: traducir la l√≥gica de inst_pregunta_territorial_estado desde Python
    return {
      mode: "single",
      prompt: "t_territorial_estado ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_territorial_autonomia() {
    // TODO: traducir la l√≥gica de inst_pregunta_territorial_autonomia desde Python
    return {
      mode: "single",
      prompt: "t_territorial_autonomia ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_territorial_municipio() {
    // TODO: traducir la l√≥gica de inst_pregunta_territorial_municipio desde Python
    return {
      mode: "single",
      prompt: "t_territorial_municipio ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_territorial_provincia() {
    // TODO: traducir la l√≥gica de inst_pregunta_territorial_provincia desde Python
    return {
      mode: "single",
      prompt: "t_territorial_provincia ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_territorial_solidaridad() {
    // TODO: traducir la l√≥gica de inst_pregunta_territorial_solidaridad desde Python
    return {
      mode: "single",
      prompt: "t_territorial_solidaridad ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_tc_funcion() {
    // TODO: traducir la l√≥gica de inst_pregunta_tc_funcion desde Python
    return {
      mode: "single",
      prompt: "t_tc_funcion ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_tc_composicion() {
    // TODO: traducir la l√≥gica de inst_pregunta_tc_composicion desde Python
    return {
      mode: "single",
      prompt: "t_tc_composicion ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_tc_mandato() {
    // TODO: traducir la l√≥gica de inst_pregunta_tc_mandato desde Python
    return {
      mode: "single",
      prompt: "t_tc_mandato ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_tc_recursos() {
    // TODO: traducir la l√≥gica de inst_pregunta_tc_recursos desde Python
    return {
      mode: "single",
      prompt: "t_tc_recursos ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_tc_conflictos() {
    // TODO: traducir la l√≥gica de inst_pregunta_tc_conflictos desde Python
    return {
      mode: "single",
      prompt: "t_tc_conflictos ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_reforma_tituloX() {
    // TODO: traducir la l√≥gica de inst_pregunta_reforma_tituloX desde Python
    return {
      mode: "single",
      prompt: "t_reforma_tituloX ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_reforma_total() {
    // TODO: traducir la l√≥gica de inst_pregunta_reforma_total desde Python
    return {
      mode: "single",
      prompt: "t_reforma_total ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_reforma_ordinaria() {
    // TODO: traducir la l√≥gica de inst_pregunta_reforma_ordinaria desde Python
    return {
      mode: "single",
      prompt: "t_reforma_ordinaria ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_reforma_dos_tercios() {
    // TODO: traducir la l√≥gica de inst_pregunta_reforma_dos_tercios desde Python
    return {
      mode: "single",
      prompt: "t_reforma_dos_tercios ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  function t_reforma_referendum() {
    // TODO: traducir la l√≥gica de inst_pregunta_reforma_referendum desde Python
    return {
      mode: "single",
      prompt: "t_reforma_referendum ‚Äî pendiente de traducci√≥n",
      options: ["A","B","C","D"],
      correct: [0]
    };
  }

  REGISTRY.types["constitucion"] = {
    name: "Constituci√≥n",
    templates: [
t_constitucion,
t_constitucion_anio,
t_caracteristica,
t_titulo,
t_no_caract_actual,
t_articulos,
t_tipo_derecho,
t_deberes,
t_promulgacion,
t_periodo_franquista,
t_pena_muerte,
t_defender_espana,
t_servicio_civil,
t_estado_excepcion,
t_medioambiente,
t_certificacion_medioambiente,
t_sga,
t_normativa_medioambiente,
t_politica_medioambiental,
t_funciones_rey,
t_abdicacion,
t_regencia,
t_tutela,
t_cortes_poder,
t_cortes_autonomia,
t_cortes_circunscripciones,
t_cortes_mesa,
t_cortes_decretos,
t_gobierno_responsabilidad_penal,
t_gobierno_investidura,
t_gobierno_vicepresidente,
t_gobierno_organo_consultivo,
t_gobierno_responsabilidad_politica,
t_relaciones_responsabilidad,
t_relaciones_interpelaciones,
t_relaciones_mocion_censura,
t_relaciones_cuestion_confianza,
t_relaciones_delegacion,
t_judicial_independencia,
t_judicial_cgpj,
t_judicial_tribunal_supremo,
t_judicial_ministerio_fiscal,
t_judicial_inalienable,
t_economia_potestad,
t_economia_presupuestos,
t_economia_principios,
t_economia_tribunal_cuentas,
t_economia_articulo128,
t_territorial_estado,
t_territorial_autonomia,
t_territorial_municipio,
t_territorial_provincia,
t_territorial_solidaridad,
t_tc_funcion,
t_tc_composicion,
t_tc_mandato,
t_tc_recursos,
t_tc_conflictos,
t_reforma_tituloX,
t_reforma_total,
t_reforma_ordinaria,
t_reforma_dos_tercios,
t_reforma_referendum
    ]
  };
})();


/* ---------- Estado ---------- */
let state = {
  typeKey: null,
  templateName: "__random__",
  mode: "estandar",   // nuevo
  total: 30,          // por defecto
  asked: 0,
  correct: 0,
  lives: 3,           // para contrarreloj/vidas
  timeLeft: 40,       // tiempo actual por pregunta
  level: 1,
  current: null,
  selection: new Set(),
  curso: null,
  modelo: null,
  modeloConfig: {}
};


/* ---------- Referencias UI ---------- */
const elStart = document.getElementById('start');
const panelConfig = document.getElementById('panel-config');
const panelTest = document.getElementById('panel-test');
const panelResult = document.getElementById('panel-result');
const elPrompt = document.getElementById('prompt');
const elOptions = document.getElementById('options');
const elExplain = document.getElementById('explain');
const elMeta = document.getElementById('meta');
const elScore = document.getElementById('score');
const elNext = document.getElementById('next');
const elCheck = document.getElementById('check');
const elModeBadge = document.getElementById('modeBadge');
const elSummary = document.getElementById('summary');
const elRetry = document.getElementById('retry');
const elHome = document.getElementById('home');
const selEsp = document.getElementById("especialidad");
const selAsig = document.getElementById("asignatura");
const selTema = document.getElementById("tema");

const selCurso = document.getElementById("curso");
const selModelo = document.getElementById("modelo");
const divOpcModelo = document.getElementById("opcionesModelo");

// Compatibilidad: ejecutar cuando el DOM est√© listo (sin syntaxes modernas)
function onReady(cb){
  if (document.readyState !== 'loading') cb();
  else document.addEventListener('DOMContentLoaded', cb);
}

// Buscar el contenedor .row de un elemento sin usar ?.closest
function getRow(el){
  var p = el;
  while (p && p !== document.body){
    if (p && p.classList && p.classList.contains('row')) return p;
    p = p.parentNode;
  }
  return null;
}

// Mostrar/ocultar nodos usando una clase CSS (m√°s robusto que style.display)
function show(node, on){
  if (!node) return;
  if (on) node.classList.remove('hide');
  else node.classList.add('hide');
}


/* ---------- L√≥gica ---------- */
function makeQuestion(){
  const def = REGISTRY.types[state.typeKey];
  let fn;
  if (state.templateName === "__random__"){
    fn = def.templates[rndInt(0, def.templates.length-1)];
  } else {
    fn = def.templates[parseInt(state.templateName,10)];
  }
  return fn();
}

function renderQuestion(){
  if (!state.typeKey || !REGISTRY.types[state.typeKey]){
    elPrompt.textContent = "‚ùå Error: no hay ejercicios cargados para este tema.";
    return;
  }

  // Usar directamente el pool ya preparado en startTest()
if (!state.pool || state.pool.length === 0){
  if (state.repeatables && state.repeatables.length > 0){
    state.pool = state.repeatables.slice();
  } else {
    showResult();
    return;
  }
}



// Elegir al azar una plantilla del pool
const idx = rndInt(0, state.pool.length - 1);
const f = state.pool[idx];
const q = f();

// Si no es repetible ‚Üí se elimina del pool
if (!q.repeatable) {
  state.pool.splice(idx, 1);
} else {
  // üîπ Si es repetible, no la quitamos: permanece en el pool
  //    (esto permite que pueda volver a salir)
}

// Guardar la pregunta actual
state.current = q;











  state.selection = new Set();

  const {mode, prompt, options} = state.current;

  elModeBadge.textContent = (mode === "multi" ? "MODO: M√∫ltiple" : "MODO: √önica");
  elPrompt.textContent = prompt || "‚Äî";
  elExplain.classList.add('hide'); 
  elExplain.textContent = "";

  // Pintar opciones
  elOptions.innerHTML = "";
  options.forEach((text, idx)=>{
    const btn = document.createElement('button');
    btn.className = 'opt';
    btn.type = "button";
    btn.dataset.index = String(idx);
    btn.innerHTML = `<strong>${String.fromCharCode(97+idx)})</strong> ${text}`;
    btn.addEventListener('click', ()=>toggleSelect(idx, btn));
    elOptions.appendChild(btn);
  });

  // Modo contrarreloj
  if (state.mode === "contrarreloj"){
    clearInterval(state.timerId);
    state.timeLeft = Math.max(20, 40 - (state.level-1)*5);
    updateHUD();
    state.timerId = setInterval(()=>{
      state.timeLeft--;
      updateHUD();
      if (state.timeLeft <= 0){
        state.lives--;
        clearInterval(state.timerId);
        if (state.lives <= 0){ 
          showResult(); 
          return; 
        } else if (state.timerId){
          clearInterval(state.timerId);
          state.timerId = null;
        }
        nextQuestion();
      }
    }, 1000);
  }

  // Meta
  elMeta.textContent = state.total ? `Pregunta ${state.asked+1} de ${state.total}` : `Pregunta ${state.asked+1}`;
  elNext.disabled = true;
  updateScore();
  updateHUD();
}




function toggleSelect(idx, elBtn){
  const mode = state.current.mode;
  if (mode === "single"){
    state.selection.clear();
    Array.from(elOptions.children).forEach(ch=>{
      ch.classList.remove('selected');
    });
    state.selection.add(idx);
    elBtn.classList.add('selected');
  } else {
    if (state.selection.has(idx)){
      state.selection.delete(idx);
      elBtn.classList.remove('selected');
    } else {
      state.selection.add(idx);
      elBtn.classList.add('selected');
    }
  }
}

function checkAnswer(){
  if (state.selection.size===0) return;

  // üîπ detener el temporizador mientras se corrige la pregunta
  if (state.mode === "contrarreloj" && state.timerId){
    clearInterval(state.timerId);
    state.timerId = null;
  }

  const correctSet = new Set(state.current.correct);
  const isCorrect =
    state.selection.size === correctSet.size &&
    Array.from(state.selection).every(i => correctSet.has(i));

  // Pintado de feedback
  Array.from(elOptions.children).forEach((btn, i)=>{
    if (correctSet.has(i)) btn.classList.add('correct');
    else if (state.selection.has(i)) btn.classList.add('wrong');
    btn.disabled = true;
  });

  if (isCorrect){
    state.correct++;
    // ‚¨ÜÔ∏è Subir nivel cada 5 aciertos ‚Üí reduce 5s (hasta 20) en contrarreloj en la siguiente pregunta
    if (state.correct % 5 === 0){
      state.level++;
    }
  } else {
    // ‚¨áÔ∏è Restar vida en contrarreloj y en vidas
    if (state.mode === "contrarreloj" || state.mode === "vidas"){
      state.lives = Math.max(0, state.lives - 1);
      updateHUD();
      if (state.lives <= 0){
        showResult();
        return;
      }
    }
  }

  // Explicaci√≥n (si la hay)
  elExplain.textContent = state.current.explanation || "";
  elExplain.classList.remove('hide');

  elNext.disabled = false;
  updateScore();
}


function nextQuestion(){
  state.asked++;
  if (state.total && state.asked >= state.total){
    showResult();
  } else {
      renderQuestion();
}
}


function updateScore(){
  elScore.textContent = `${state.correct} / ${state.asked} acertadas`;
}

function startTest(){
  if (state.timerId) {
    clearInterval(state.timerId);
    state.timerId = null;
  }

  const esp = selEsp.value;
  const asig = selAsig.value;
  const tema = selTema.value;
  const modoSel = document.getElementById("modo").value;

  state.curso = selCurso.value;
  if (!state.curso){ 
    alert("Selecciona el curso acad√©mico."); 
    return; 
  }

  state.modelo = selModelo.value;
  if (!state.modelo){ 
    alert("Selecciona el modelo (A‚ÄìE)."); 
    return; 
  }

  state.mode = modoSel;
  state.asked = 0;
  state.correct = 0;
  state.lives = 3;
  state.level = 1;
  state.timeLeft = 40;
  state.selection = new Set();

  // Inicializar arrays vac√≠os para evitar errores
  state.pool = [];
  state.repeatables = [];

  // üîπ Definimos un mapeo de combinaciones a typeKey
  const MAPEO_TEMAS = {
    "GENERAL|Constituci√≥n|Test Constituci√≥n": "constitucion",
    "GENERAL|EOFAS|EOFAS": "eofas",
    "MER|Matem√°ticas|Aritm√©tica": "matematicas_aritmetica",
    "ELC|Matem√°ticas|Aritm√©tica": "matematicas_aritmetica",
    "MER|Fundamentos de electricidad|Teor√≠a de los electrones": "teoria_electrones",
    "ELC|Fundamentos de electricidad|Teor√≠a de los electrones": "teoria_electrones"
  };

  // Construimos la clave con lo que seleccion√≥ el usuario
  const key = `${esp}|${asig}|${tema}`;
  state.typeKey = MAPEO_TEMAS[key];

  // Si no est√° implementado ‚Üí mostrar aviso, pero mantener el wizard abierto
  if (!state.typeKey || !REGISTRY.types[state.typeKey]) {
    alert(`‚ö†Ô∏è Tema a√∫n no implementado: ${esp} ‚Üí ${asig} ‚Üí ${tema}`);
    return;  // üëà ya no oculta ni reinicia, solo no arranca el test
  }

  // üîπ Construir pool filtrado
  const def = REGISTRY.types[state.typeKey];
  const templates = Array.isArray(def.templates) ? def.templates : [];

  // Construir el pool inicial de plantillas v√°lidas seg√∫n el modelo
  state.pool = templates.filter(f => {
    try {
      if (f.name === "configuracion_electronica" && state.modelo === "B") return false;
      const q = f();
      return q && Array.isArray(q.modelos) && q.modelos.includes(state.modelo);
    } catch(e){ 
      return false; 
    }
  });

  // Guardar aparte las repetibles para reponerlas cuando se vac√≠e el pool
  state.repeatables = templates.filter(f => {
    try {
      if (f.name === "configuracion_electronica" && state.modelo === "B") return false;
      const q = f();
      return q && Array.isArray(q.modelos) && q.modelos.includes(state.modelo) && q.repeatable === true;
    } catch(e){ 
      return false; 
    }
  });

  // Si no hay preguntas en el pool ‚Üí avisar y volver al wizard
  if (state.pool.length === 0){
    alert(`‚ö†Ô∏è El tema ${def.name} no tiene preguntas para el modelo ${state.modelo}.`);
    panelTest.classList.add('hide');
    panelConfig.classList.remove('hide');
    return;
  }

  // Ajustar n√∫mero total de preguntas seg√∫n modo
  if (state.mode === "estandar") {
    // üîπ Comprobar si el tema tiene plantillas repetibles
    const hasRepeatables = templates.some(f => {
      try {
        const q = f();
        return q.repeatable === true;
      } catch(e) {
        return false;
      }
    });

    if (hasRepeatables) {
      state.total = 30;   // ‚úÖ fija 30 preguntas aunque se repitan
    } else {
      state.total = state.pool.length;  // ‚úÖ solo las disponibles (no repetibles)
    }
  } else {
    state.total = null;  // en otros modos (vidas, contrarreloj) no hay l√≠mite fijo
  }

  // Mostrar panel del test
  panelConfig.classList.add('hide');
  panelResult.classList.add('hide');
  panelTest.classList.remove('hide');

  updateHUD();
  renderQuestion();
}




// En el script
function updateHUD(){
  if (state.mode!=="estandar"){
    document.getElementById("lives").textContent = "‚ù§".repeat(state.lives);
  } else {
    document.getElementById("lives").textContent = "";
  }
  if (state.mode==="contrarreloj"){
    document.getElementById("timer").textContent = state.timeLeft+"s";
  } else {
    document.getElementById("timer").textContent = "";
  }
}


function showResult(){
  panelTest.classList.add('hide');
  panelResult.classList.remove('hide');

  if (state.total){
    elSummary.textContent = `Has acertado ${state.correct} de ${state.total} (${Math.round(100*state.correct/state.total)}%).`;
  } else {
    elSummary.textContent = `Has acertado ${state.correct} preguntas.`;
  }
}


/* ---------- Eventos ---------- */
elStart.addEventListener('click', startTest);
elCheck.addEventListener('click', checkAnswer);
elNext.addEventListener('click', nextQuestion);
elRetry.addEventListener('click', startTest);
elHome.addEventListener('click', ()=>{
  if (state.timerId) { clearInterval(state.timerId); state.timerId = null; }
  panelResult.classList.add('hide');
  panelConfig.classList.remove('hide');
});



/* ---------- Atajos ---------- */
window.addEventListener('keydown', (e)=>{
  if (panelTest.classList.contains('hide')) return;
  const key = e.key.toLowerCase();
  const map = { a:0, b:1, c:2, d:3 };
  if (key in map){
    const idx = map[key];
    const btn = elOptions.children[idx];
    if (btn && !btn.disabled) btn.click();
  } else if (key === 'enter'){
    if (!elNext.disabled) nextQuestion(); else checkAnswer();
  } else if (key === 'n'){
    if (!elNext.disabled) nextQuestion();
  }
});


/* ---------- Datos de especialidades ---------- */
const ESPECIALIDADES_BY_CURSO = {
  "Promocion_XXXIV_STP": {},
  "Promocion_XXXV_STP": {},
  "Promocion_XXXVI_STP": {
    "GENERAL": {
      "Constituci√≥n": ["Test Constituci√≥n"],
      "EOFAS": ["EOFAS"],
    },
    "CAE": {
      "T√©cnicas y Procesos de Infraestructuras y Telecomunicaciones":["Replanteo de infraestructuras de sistemas de telecomunicaciones"],
      "Sistemas de telefon√≠a fija y m√≥vil":["Introducci√≥n","Introducci√≥n a la telefon√≠a","Evoluci√≥n de la estructura de la red telef√≥nica","La se√±al telef√≥nica","Telefon√≠a digital","Multiplexaci√≥n de canales MIC","Tecnolog√≠as de banda ancha. RDSI y ATM","Estructura de la red y tr√°fico telef√≥nico", "Conmutaci√≥n telef√≥nica","Sistemas digitales de conmutaci√≥n","Sistema privado de conmutaci√≥n PBX"],
      "Auditor√≠a Redes WIFI":["Introducci√≥n","Herramientas de auditor√≠a de redes LAN inal√°mbricas","Criptograf√≠a","Medidas de seguridad b√°sicas","Herramientas de captura y analisis de tr√°fico TCP/IP"],
      "Elementos de Sistemas de Telecomunicaciones":["Magnitudes y unidades"]
    },
    "CYB": {
      "T√©cnicas y Procesos de Infraestructuras y Telecomunicaciones":["Replanteo de infraestructuras de sistemas de telecomunicaciones"],
      "Sistemas de telefon√≠a fija y m√≥vil":["Introducci√≥n","Introducci√≥n a la telefon√≠a","Evoluci√≥n de la estructura de la red telef√≥nica","La se√±al telef√≥nica","Telefon√≠a digital","Multiplexaci√≥n de canales MIC","Tecnolog√≠as de banda ancha. RDSI y ATM","Estructura de la red y tr√°fico telef√≥nico", "Conmutaci√≥n telef√≥nica","Sistemas digitales de conmutaci√≥n","Sistema privado de conmutaci√≥n PBX"],
      "Auditor√≠a Redes WIFI":["Introducci√≥n","Herramientas de auditor√≠a de redes LAN inal√°mbricas","Criptograf√≠a","Medidas de seguridad b√°sicas","Herramientas de captura y analisis de tr√°fico TCP/IP"],
      "Elementos de Sistemas de Telecomunicaciones":["Magnitudes y unidades"]
    },
    "MER": {
      "Matem√°ticas":["Aritm√©tica","√Ålgebra","Geometr√≠a"],
      "F√≠sica":["La materia","Mec√°nica","Termodin√°mica","√ìptica","Movimiento ondulatorio y sonido"],
      "Fundamentos de electricidad":["Teor√≠a de los electrones", "Electricidad est√°tica y conducci√≥n", "Terminolog√≠a el√©ctrica","Generaci√≥n de electricidad", "Fuentes de corriente continua","Circuitos de corriente continua","Resistencias y resistores","Potencia","Capacidad y condensadores","Magnetismo","Inductancia e inductores", "Teor√≠a del motor/Generador DC","Teor√≠a de corriente alterna","Circuitos RLC","Transformadores", "Filtros", "Generadores AC","Motores AC"],
      "Fundamentos de electr√≥nica":["Semiconductores","Diodos","Transistores", "Circuitos integrados", "Placas de circuitos impresos","Servomecanismos"],
      "Estrucutras de las aeronaves":["Cap√≠tulo 0","Forma del fuselaje","Esfuerzos y deformaci√≥n","Propiedades de los materiales","Modos de trabajo de la estructura del fuselaje", "Tipos de cargas generales que act√∫an en el avi√≥n","Velocidades de influencia estructural","Secci√≥n D","Cargas estructurales en el helic√≥ptero","Certificaci√≥n de las estructuras aeron√°uticas","Pabrisas y ventanillas de cabina","Estructura del ala", "Estructurade las superficies de cola: estabilizadores"],
      "Factores humanos en mantenimiento aeromec√°mico":["Generalidades","Rendimiento y limitaciones humanas","Psicolog√≠a social", "Factores que afectan al rendimiento","Entorno f√≠sico","Tareas","Comunaci√≥n","Error humano","Riesgos Laborales"]
    },
    "ELC": {
      "Matem√°ticas":["Aritm√©tica","√Ålgebra","Geometr√≠a"],
      "F√≠sica":["La materia","Mec√°nica","Termodin√°mica","√ìptica","Movimiento ondulatorio y sonido"],
      "Fundamentos de electricidad":["Teor√≠a de los electrones", "Electricidad est√°tica y conducci√≥n", "Terminolog√≠a el√©ctrica","Generaci√≥n de electricidad", "Fuentes de corriente continua","Circuitos de corriente continua","Resistencias y resistores","Potencia","Capacidad y condensadores","Magnetismo","Inductancia e inductores", "Teor√≠a del motor/Generador DC","Teor√≠a de corriente alterna","Circuitos RLC","Transformadores", "Filtros", "Generadores AC","Motores AC"],
      "Fundamentos de electr√≥nica":["Semiconductores","Diodos","Transistores", "Circuitos integrados", "Placas de circuitos impresos","Servomecanismos"],
      "Estrucutras de las aeronaves":["Cap√≠tulo 0","Forma del fuselaje","Esfuerzos y deformaci√≥n","Propiedades de los materiales","Modos de trabajo de la estructura del fuselaje", "Tipos de cargas generales que act√∫an en el avi√≥n","Velocidades de influencia estructural","Secci√≥n D","Cargas estructurales en el helic√≥ptero","Certificaci√≥n de las estructuras aeron√°uticas","Pabrisas y ventanillas de cabina","Estructura del ala", "Estructurade las superficies de cola: estabilizadores"],
      "Factores humanos en mantenimiento aeromec√°mico":["Generalidades","Rendimiento y limitaciones humanas","Psicolog√≠a social", "Factores que afectan al rendimiento","Entorno f√≠sico","Tareas","Comunaci√≥n","Error humano","Riesgos Laborales"]
    },
    "AYF": {},
    "PAO": {
      "T√©cnicas y Procesos de Infraestructuras y Telecomunicaciones":["Replanteo de infraestructuras de sistemas de telecomunicaciones"],
      "Sistemas de telefon√≠a fija y m√≥vil":["Introducci√≥n","Introducci√≥n a la telefon√≠a","Evoluci√≥n de la estructura de la red telef√≥nica","La se√±al telef√≥nica","Telefon√≠a digital","Multiplexaci√≥n de canales MIC","Tecnolog√≠as de banda ancha. RDSI y ATM","Estructura de la red y tr√°fico telef√≥nico", "Conmutaci√≥n telef√≥nica","Sistemas digitales de conmutaci√≥n","Sistema privado de conmutaci√≥n PBX"],
      "Auditor√≠a Redes WIFI":["Introducci√≥n","Herramientas de auditor√≠a de redes LAN inal√°mbricas","Criptograf√≠a","Medidas de seguridad b√°sicas","Herramientas de captura y analisis de tr√°fico TCP/IP"],
      "Elementos de Sistemas de Telecomunicaciones":["Magnitudes y unidades"]
    }
  }
};

/* ---------- Flujo paso a paso (wizard) y opciones de modelo ---------- */
function updateStartEnabled(){
  const okCurso = !!selCurso.value;
  const okEsp   = !!selEsp.value;
  const okAsig  = !!selAsig.value;
  const okTema  = !!selTema.value;

  const modoSel = document.getElementById("modo").value;
  let okModo = !!modoSel;

  const modelo  = selModelo.value;
  let okModelo  = !!modelo;

  // Validaciones espec√≠ficas de C/E
  if (modelo === "C"){
    var tipoCEl = document.getElementById("tipoC");
    const tipoC = (tipoCEl && tipoCEl.value) ? tipoCEl.value : "";
    okModelo = okModelo && !!tipoC;
  } else if (modelo === "E"){
    const grupos = Array.from(document.querySelectorAll('input[name="grupoE"]:checked'));
    const tipos  = Array.from(document.querySelectorAll('input[name="tipoE"]:checked'));
    const requiereTipos = (
      selAsig.value.toLowerCase().includes("matem") ||
      selTema.value.toLowerCase().includes("aritm")
    );
    okModelo = okModelo && grupos.length > 0 && (requiereTipos ? tipos.length > 0 : true);
  }

  // El bot√≥n siempre est√° visible, solo se activa/desactiva
  const ready = okCurso && okEsp && okAsig && okTema && okModo && okModelo;
  elStart.disabled = !ready;
}


function renderModelOptions(){
  const modelo = selModelo.value;
  divOpcModelo.innerHTML = "";
  divOpcModelo.classList.add("hide");

  if (!modelo){ updateStartEnabled(); return; }

  if (modelo === "C"){
    divOpcModelo.innerHTML = `
      <div class="row row-2">
        <div>
          <label for="tipoC">Modelo C ‚Äî ¬øqu√© quieres?</label>
          <select id="tipoC">
            <option value="">-- Selecciona --</option>
            <option value="teoria">Teor√≠a</option>
            <option value="practica">Pr√°ctica</option>
            <option value="ambas">Ambas</option>
          </select>
        </div>
      </div>
    `;
    divOpcModelo.classList.remove("hide");
    document.getElementById("tipoC").addEventListener("change", updateStartEnabled);
  } else if (modelo === "E"){
    divOpcModelo.innerHTML = `
      <div class="row row-2">
        <div>
          <label>Grupos (puedes marcar varios)</label><br>
          <label class="pill"><input type="checkbox" name="grupoE" value="A"> Grupo A (Daypo)</label><br>
          <label class="pill"><input type="checkbox" name="grupoE" value="B"> Grupo B (Libro)</label><br>
          <label class="pill"><input type="checkbox" name="grupoE" value="C"> Grupo C (Diario)</label><br>
          <label class="pill"><input type="checkbox" name="grupoE" value="D"> Grupo D (Todo)</label>
        </div>
      </div>
      <div class="spacer"></div>
      <div class="row row-2">
        <div>
          <label>Tipos de ejercicio (si aplica)</label><br>
          <label class="pill"><input type="checkbox" name="tipoE" value="suma_basica"> Sumas</label><br>
          <label class="pill"><input type="checkbox" name="tipoE" value="resta_basica"> Restas</label><br>
          <label class="pill"><input type="checkbox" name="tipoE" value="multiplicacion_basica"> Multiplicaciones</label>
        </div>
      </div>
    `;
    divOpcModelo.classList.remove("hide");
    Array.from(divOpcModelo.querySelectorAll('input[name="grupoE"], input[name="tipoE"]')).forEach(ch => {
      ch.addEventListener("change", updateStartEnabled);
    });
  }
  updateStartEnabled();
}


function setupWizard(){
  // Referencias a bloques (no usar getRow con E/A/T porque comparten la misma fila)
  var rowEsp    = document.getElementById("bloque-esp");
  var rowAsig   = document.getElementById("bloque-asig");
  var rowTema   = document.getElementById("bloque-tema");
  var rowModo   = getRow(document.getElementById("modo"));
  var rowModelo = getRow(selModelo);
  var rowStart  = getRow(elStart);

  // Estado inicial ‚Äî solo visible "Curso"
  show(rowEsp,    false);
  show(rowAsig,   false);
  show(rowTema,   false);
  show(rowModo,   false);
  show(rowModelo, false);
  // ‚ùå no ocultamos rowStart, el bot√≥n siempre se ve

  selAsig.disabled = true;
  selTema.disabled = true;
  divOpcModelo.classList.add('hide');
  divOpcModelo.innerHTML = "";

  // PASO 1 ‚Üí Curso
  selCurso.addEventListener("change", function(){
    // Reset dependientes
    selEsp.value = "";
    selAsig.innerHTML = '<option value="">-- Selecciona asignatura --</option>';
    selTema.innerHTML = '<option value="">-- Selecciona tema --</option>';
    selAsig.disabled = true;
    selTema.disabled = true;
    document.getElementById("modo").value = "";
    selModelo.value = "";
    divOpcModelo.classList.add('hide');
    divOpcModelo.innerHTML = "";

    // Mostrar solo lo siguiente
    show(rowEsp,    !!selCurso.value);
    show(rowAsig,   false);
    show(rowTema,   false);
    show(rowModo,   false);
    show(rowModelo, false);

    updateStartEnabled();
  });

  // PASO 2 ‚Üí Especialidad
  selEsp.addEventListener("change", function(){
    selAsig.innerHTML = '<option value="">-- Selecciona asignatura --</option>';
    selTema.innerHTML = '<option value="">-- Selecciona tema --</option>';
    selAsig.disabled = true;
    selTema.disabled = true;

    var cursoSel = selCurso.value;
    if (!cursoSel){
      alert("‚ö†Ô∏è Selecciona primero el curso acad√©mico.");
      selEsp.value = "";
      return;
    }
    var esp = selEsp.value;
    var data = ESPECIALIDADES_BY_CURSO[cursoSel] && ESPECIALIDADES_BY_CURSO[cursoSel][esp];

    if (data){
      Object.keys(data).forEach(function(a){
        var opt = document.createElement("option");
        opt.value = a; opt.textContent = a;
        selAsig.appendChild(opt);
      });
      selAsig.disabled = Object.keys(data).length === 0;
    } else {
      selAsig.innerHTML = '<option value="">‚Äî Sin datos para esta especialidad ‚Äî</option>';
      selAsig.disabled = true;
    }

    show(rowAsig,   true);
    show(rowTema,   false);
    show(rowModo,   false);
    show(rowModelo, false);

    updateStartEnabled();
  });

  // PASO 3 ‚Üí Asignatura
  selAsig.addEventListener("change", function(){
    selTema.innerHTML = '<option value="">-- Selecciona tema --</option>';
    selTema.disabled = true;

    var cursoSel = selCurso.value;
    var esp = selEsp.value;
    var asig = selAsig.value;
    var temas = ESPECIALIDADES_BY_CURSO[cursoSel] &&
                ESPECIALIDADES_BY_CURSO[cursoSel][esp] &&
                ESPECIALIDADES_BY_CURSO[cursoSel][esp][asig];

    if (Array.isArray(temas)){
      temas.forEach(function(t){
        var opt = document.createElement("option");
        opt.value = t; opt.textContent = t;
        selTema.appendChild(opt);
      });
      selTema.disabled = temas.length === 0;
    }

    show(rowTema,   true);
    show(rowModo,   false);
    show(rowModelo, false);

    // Reset de modo/modelo
    document.getElementById("modo").value = "";
    selModelo.value = "";
    divOpcModelo.classList.add('hide');
    divOpcModelo.innerHTML = "";

    updateStartEnabled();
  });

  // PASO 4 ‚Üí Tema
  selTema.addEventListener("change", function(){
    show(rowModo,   !!selTema.value);
    show(rowModelo, false);

    // Reset modelo/opciones
    selModelo.value = "";
    divOpcModelo.classList.add('hide');
    divOpcModelo.innerHTML = "";

    updateStartEnabled();
  });

  // PASO 5 ‚Üí Modo
  document.getElementById("modo").addEventListener("change", function(){
    show(rowModelo, !!this.value);

    // Reset modelo/opciones
    selModelo.value = "";
    divOpcModelo.classList.add('hide');
    divOpcModelo.innerHTML = "";

    updateStartEnabled();
  });

  // PASO 6 ‚Üí Modelo
  selModelo.addEventListener("change", function(){
    renderModelOptions();
    updateStartEnabled();
  });

  // Recalcular si cambia el modo (vidas/tiempo)
  var modoSel = document.getElementById("modo");
  if (modoSel) modoSel.addEventListener("change", updateStartEnabled);

  updateStartEnabled();
}






// Ejecutar setup inmediatamente (el script est√° al final del body)





onReady(function(){
  setupWizard();
});


const ELEMENTOS = {
  1: { nombre: "Hidr√≥geno", config: "1s¬π" },
  2: { nombre: "Helio", config: "1s¬≤" },
  3: { nombre: "Litio", config: "1s¬≤ 2s¬π" },
  4: { nombre: "Berilio", config: "1s¬≤ 2s¬≤" },
  5: { nombre: "Boro", config: "1s¬≤ 2s¬≤ 2p¬π" },
  6: { nombre: "Carbono", config: "1s¬≤ 2s¬≤ 2p¬≤" },
  7: { nombre: "Nitr√≥geno", config: "1s¬≤ 2s¬≤ 2p¬≥" },
  8: { nombre: "Ox√≠geno", config: "1s¬≤ 2s¬≤ 2p‚Å¥" },
  9: { nombre: "Fl√∫or", config: "1s¬≤ 2s¬≤ 2p‚Åµ" },
  10: { nombre: "Ne√≥n", config: "1s¬≤ 2s¬≤ 2p‚Å∂" },
  11: { nombre: "Sodio", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬π" },
  12: { nombre: "Magnesio", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤" },
  13: { nombre: "Aluminio", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p¬π" },
  14: { nombre: "Silicio", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p¬≤" },
  15: { nombre: "F√≥sforo", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p¬≥" },
  16: { nombre: "Azufre", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å¥" },
  17: { nombre: "Cloro", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Åµ" },
  18: { nombre: "Arg√≥n", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂" },
  19: { nombre: "Potasio", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 4s¬π" },
  20: { nombre: "Calcio", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 4s¬≤" },
  21: { nombre: "Escandio", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 3d¬π 4s¬≤" },
  22: { nombre: "Titanio", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 3d¬≤ 4s¬≤" },
  23: { nombre: "Vanadio", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 3d¬≥ 4s¬≤" },
  24: { nombre: "Cromo", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 3d‚Åµ 4s¬π" },
  25: { nombre: "Manganeso", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 3d‚Åµ 4s¬≤" },
  26: { nombre: "Hierro", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 3d‚Å∂ 4s¬≤" },
  27: { nombre: "Cobalto", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 3d‚Å∑ 4s¬≤" },
  28: { nombre: "N√≠quel", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 3d‚Å∏ 4s¬≤" },
  29: { nombre: "Cobre", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 3d¬π‚Å∞ 4s¬π" },
  30: { nombre: "Zinc", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 3d¬π‚Å∞ 4s¬≤" },
  31: { nombre: "Galio", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 3d¬π‚Å∞ 4s¬≤ 4p¬π" },
  32: { nombre: "Germanio", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 3d¬π‚Å∞ 4s¬≤ 4p¬≤" },
  33: { nombre: "Ars√©nico", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 3d¬π‚Å∞ 4s¬≤ 4p¬≥" },
  34: { nombre: "Selenio", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 3d¬π‚Å∞ 4s¬≤ 4p‚Å¥" },
  35: { nombre: "Bromo", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 3d¬π‚Å∞ 4s¬≤ 4p‚Åµ" },
  36: { nombre: "Kript√≥n", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 3d¬π‚Å∞ 4s¬≤ 4p‚Å∂" },
  37: { nombre: "Rubidio", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 3d¬π‚Å∞ 4s¬≤ 4p‚Å∂ 5s¬π" },
  38: { nombre: "Estroncio", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 3d¬π‚Å∞ 4s¬≤ 4p‚Å∂ 5s¬≤" },
  39: { nombre: "Itrio", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 3d¬π‚Å∞ 4s¬≤ 4p‚Å∂ 4d¬π 5s¬≤" },
  40: { nombre: "Circonio", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 3d¬π‚Å∞ 4s¬≤ 4p‚Å∂ 4d¬≤ 5s¬≤" },
  41: { nombre: "Niobio", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 3d¬π‚Å∞ 4s¬≤ 4p‚Å∂ 4d‚Å¥ 5s¬π" },
  42: { nombre: "Molibdeno", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 3d¬π‚Å∞ 4s¬≤ 4p‚Å∂ 4d‚Åµ 5s¬π" },
  43: { nombre: "Tecnecio", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 3d¬π‚Å∞ 4s¬≤ 4p‚Å∂ 4d‚Åµ 5s¬≤" },
  44: { nombre: "Rutenio", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 3d¬π‚Å∞ 4s¬≤ 4p‚Å∂ 4d‚Å∑ 5s¬π" },
  45: { nombre: "Rodio", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 3d¬π‚Å∞ 4s¬≤ 4p‚Å∂ 4d‚Å∏ 5s¬π" },
  46: { nombre: "Paladio", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 3d¬π‚Å∞ 4s¬≤ 4p‚Å∂ 4d¬π‚Å∞" },
  47: { nombre: "Plata", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 3d¬π‚Å∞ 4s¬≤ 4p‚Å∂ 4d¬π‚Å∞ 5s¬π" },
  48: { nombre: "Cadmio", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 3d¬π‚Å∞ 4s¬≤ 4p‚Å∂ 4d¬π‚Å∞ 5s¬≤" },
  49: { nombre: "Indio", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 3d¬π‚Å∞ 4s¬≤ 4p‚Å∂ 4d¬π‚Å∞ 5s¬≤ 5p¬π" },
  50: { nombre: "Esta√±o", config: "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Å∂ 3d¬π‚Å∞ 4s¬≤ 4p‚Å∂ 4d¬π‚Å∞ 5s¬≤ 5p¬≤" },
};



function configuracion_electronica(){
  const Z = Math.floor(Math.random() * 50) + 1;
  const elem = ELEMENTOS[Z];
  const pregunta = `¬øCu√°l es la configuraci√≥n electr√≥nica del ${elem.nombre} (Z=${Z})?`;
  const correcta = elem.config;

  const distractores = new Set();

  function generarIncorrecta(){
    const modo = rndInt(1,4);
    let propuesta = "";

    if (modo === 1){
      const partes = correcta.split(" ");
      if (partes.length > 1) propuesta = [...partes].reverse().join(" ");
    } else if (modo === 2){
      let offset = Z + (Math.random() < 0.5 ? -9 : 9);
      if (ELEMENTOS[offset]) propuesta = ELEMENTOS[offset].config;
    } else if (modo === 3){
      propuesta = correcta.replace(/s/g,"p").replace(/p/g,"s");
    } else {
      propuesta = correcta.replace(/p6/,"p7").replace(/d10/,"d11");
    }

    return propuesta;
  }

  while (distractores.size < 3){
    const cand = generarIncorrecta();
    if (cand && cand !== correcta && !distractores.has(cand)){
      distractores.add(cand);
    }
  }

  const opciones = shuffle([correcta, ...distractores]);

  return {
    tema: "Teor√≠a de los electrones",
    modelos: ["C","D"],
    repeatable: true,
    mode: "single",
    prompt: pregunta,
    options: opciones,
    correct: [opciones.indexOf(correcta)]
  };
}

function pregunta_teoria_de_los_electrones_1() {
  let correcta = "Protones y neutrones";
  let incorrectas = [
    "Electrones y protones",
    "Electrones y neutrones",
    "Electrones, protones y neutrones"
  ];

  let opciones = [correcta, ...incorrectas];
  opciones = shuffle(opciones);

  return {
    mode: "single",
    prompt: "¬øQu√© part√≠culas forman el n√∫cleo at√≥mico?",
    options: opciones,
    correct: [opciones.indexOf(correcta)],
    modelos: ["B","D"],
    repeatable: false
  };
}


function pregunta_teoria_de_los_electrones_2() {
  let correcta = "Ligeramente menor que la del neutr√≥n";
  let incorrectas = [
    "Exactamente igual a la del neutr√≥n",
    "Mayor que la del neutr√≥n",
    "La mitad de la del neutr√≥n"
  ];

  let opciones = [correcta, ...incorrectas];
  opciones = shuffle(opciones);

  return {
    mode: "single",
    prompt: "La masa del prot√≥n es...",
    options: opciones,
    correct: [opciones.indexOf(correcta)],
    modelos: ["B","D"],
    repeatable: false
  };
}


function pregunta_teoria_de_los_electrones_3() {
  let correcta = "Igual en magnitud y de signo contrario";
  let incorrectas = [
    "Mayor en magnitud y del mismo signo",
    "Menor en magnitud y de signo contrario",
    "Igual en magnitud y del mismo signo"
  ];

  let opciones = [correcta, ...incorrectas];
  opciones = shuffle(opciones);

  return {
    mode: "single",
    prompt: "La carga del prot√≥n, en comparaci√≥n con la del electr√≥n, es...",
    options: opciones,
    correct: [opciones.indexOf(correcta)],
    modelos: ["B","D"],
    repeatable: false
  };
}


function pregunta_teoria_de_los_electrones_4() {
  let correcta = "Aproximadamente 1/1836 de la masa del prot√≥n";
  let incorrectas = [
    "Igual a la masa del prot√≥n",
    "El doble de la masa del prot√≥n",
    "Aproximadamente 1/100 de la masa del prot√≥n"
  ];

  let opciones = [correcta, ...incorrectas];
  opciones = shuffle(opciones);

  return {
    mode: "single",
    prompt: "La masa del electr√≥n es...",
    options: opciones,
    correct: [opciones.indexOf(correcta)],
    modelos: ["B","D"],
    repeatable: false
  };
}


function pregunta_teoria_de_los_electrones_5() {
  let correcta = "Que el n√∫mero de protones es igual al n√∫mero de electrones";
  let incorrectas = [
    "Que el n√∫mero de protones es igual al n√∫mero de neutrones",
    "Que el n√∫mero de electrones es igual al n√∫mero de neutrones",
    "Que el n√∫mero de protones, electrones y neutrones es siempre el mismo"
  ];

  let opciones = [correcta, ...incorrectas];
  opciones = shuffle(opciones);

  return {
    mode: "single",
    prompt: "¬øQu√© significa que un √°tomo est√© en equilibrio?",
    options: opciones,
    correct: [opciones.indexOf(correcta)],
    modelos: ["B","D"],
    repeatable: false
  };
}


function pregunta_teoria_de_los_electrones_6() {
  let correcta = "El n√∫mero cu√°ntico azimutal (l)";
  let incorrectas = [
    "El n√∫mero cu√°ntico principal (n)",
    "El n√∫mero cu√°ntico magn√©tico (m)",
    "El n√∫mero cu√°ntico de esp√≠n (s)"
  ];

  let opciones = [correcta, ...incorrectas];
  opciones = shuffle(opciones);

  return {
    mode: "single",
    prompt: "¬øQu√© n√∫mero cu√°ntico determina la forma del orbital at√≥mico?",
    options: opciones,
    correct: [opciones.indexOf(correcta)],
    modelos: ["B","D"],
    repeatable: false
  };
}


function pregunta_teoria_de_los_electrones_7() {
  let correcta = "El n√∫mero cu√°ntico magn√©tico (m)";
  let incorrectas = [
    "El n√∫mero cu√°ntico principal (n)",
    "El n√∫mero cu√°ntico azimutal (l)",
    "El n√∫mero cu√°ntico de esp√≠n (s)"
  ];

  let opciones = [correcta, ...incorrectas];
  opciones = shuffle(opciones);

  return {
    mode: "single",
    prompt: "¬øQu√© n√∫mero cu√°ntico determina la orientaci√≥n del orbital at√≥mico?",
    options: opciones,
    correct: [opciones.indexOf(correcta)],
    modelos: ["B","D"],
    repeatable: false
  };
}


function pregunta_teoria_de_los_electrones_8() {
  let correcta = "El nivel de energ√≠a y tama√±o del orbital";
  let incorrectas = [
    "La forma del orbital",
    "La orientaci√≥n espacial del orbital",
    "El esp√≠n del electr√≥n"
  ];

  let opciones = [correcta, ...incorrectas];
  opciones = shuffle(opciones);

  return {
    mode: "single",
    prompt: "¬øQu√© describe el n√∫mero cu√°ntico principal (n)?",
    options: opciones,
    correct: [opciones.indexOf(correcta)],
    modelos: ["B","D"],
    repeatable: false
  };
}


function pregunta_teoria_de_los_electrones_9() {
  let correcta = "La orientaci√≥n del giro intr√≠nseco del electr√≥n";
  let incorrectas = [
    "La energ√≠a del orbital",
    "La forma del orbital",
    "La orientaci√≥n espacial del orbital"
  ];

  let opciones = [correcta, ...incorrectas];
  opciones = shuffle(opciones);

  return {
    mode: "single",
    prompt: "¬øQu√© indica el n√∫mero cu√°ntico de esp√≠n (s)?",
    options: opciones,
    correct: [opciones.indexOf(correcta)],
    modelos: ["B","D"],
    repeatable: false
  };
}


function pregunta_teoria_de_los_electrones_10() {
  let correcta = "2 electrones";
  let incorrectas = [
    "1 electr√≥n",
    "4 electrones",
    "Hasta 8 electrones"
  ];

  let opciones = [correcta, ...incorrectas];
  opciones = shuffle(opciones);

  return {
    mode: "single",
    prompt: "¬øCu√°ntos electrones pueden alojarse como m√°ximo en un suborbital?",
    options: opciones,
    correct: [opciones.indexOf(correcta)],
    modelos: ["B","D"],
    repeatable: false
  };
}


function pregunta_teoria_de_los_electrones_11() {
  let correcta = "Cati√≥n";
  let incorrectas = [
    "Ani√≥n",
    "Mol√©cula",
    "Prot√≥n"
  ];

  let opciones = [correcta, ...incorrectas];
  opciones = shuffle(opciones);

  return {
    mode: "single",
    prompt: "Cuando un √°tomo pierde un electr√≥n se forma un...",
    options: opciones,
    correct: [opciones.indexOf(correcta)],
    modelos: ["B","D"],
    repeatable: false
  };
}


function pregunta_teoria_de_los_electrones_12() {
  let correcta = "La compartici√≥n de electrones entre √°tomos";
  let incorrectas = [
    "La transferencia completa de electrones", 
    "La atracci√≥n electrost√°tica entre iones", 
    "La presencia de un mar de electrones libres"
  ];

  let opciones = [correcta, ...incorrectas];
  opciones = shuffle(opciones);

  return {
    mode: "single",
    prompt: "¬øQu√© caracteriza al enlace covalente?",
    options: opciones,
    correct: [opciones.indexOf(correcta)],
    modelos: ["B","D"],
    repeatable: false
  };
}


function pregunta_teoria_de_los_electrones_13() {
  let correcta = "Entre no metales";
  let incorrectas = [
    "Entre metales y no metales",
    "Entre metales",
    "Entre gases nobles"
  ];

  let opciones = [correcta, ...incorrectas];
  opciones = shuffle(opciones);

  return {
    mode: "single",
    prompt: "¬øEntre qu√© tipos de elementos se da un enlace covalente?",
    options: opciones,
    correct: [opciones.indexOf(correcta)],
    modelos: ["B","D"],
    repeatable: false
  };
}


function pregunta_teoria_de_los_electrones_14() {
  let correcta = "La energ√≠a necesaria para introducir un electr√≥n en un √°tomo neutro";
  let incorrectas = [
    "La energ√≠a necesaria para arrancar un electr√≥n de un √°tomo neutro", 
    "La capacidad de un √°tomo para atraer electrones en un enlace qu√≠mico", 
    "La energ√≠a necesaria para separar protones y neutrones en el n√∫cleo"
  ];

  let opciones = [correcta, ...incorrectas];
  opciones = shuffle(opciones);

  return {
    mode: "single",
    prompt: "¬øQu√© es la afinidad electr√≥nica?",
    options: opciones,
    correct: [opciones.indexOf(correcta)],
    modelos: ["B","D"],
    repeatable: false
  };
}


function pregunta_teoria_de_los_electrones_15() {
  let correcta = "Negativa, tienden a ceder electrones, son reductores y se oxidan";
  let incorrectas = [
    "Positiva, tienden a ganar electrones, son oxidantes y se reducen",
    "Negativa, tienden a ganar electrones, son oxidantes y se reducen",
    "Positiva, tienden a ceder electrones, son reductores y se oxidan"
  ];

  let opciones = [correcta, ...incorrectas];
  opciones = shuffle(opciones);

  return {
    mode: "single",
    prompt: "Los metales tienen una afinidad electr√≥nica...",
    options: opciones,
    correct: [opciones.indexOf(correcta)],
    modelos: ["B","D"],
    repeatable: false
  };
}


function pregunta_teoria_de_los_electrones_16() {
  let correcta = "En la transferencia completa de electrones entre un metal y un no metal, form√°ndose iones que se atraen por fuerzas electrost√°ticas";
  let incorrectas = [
    "En la compartici√≥n de electrones entre √°tomos no met√°licos",  
    "En la existencia de un mar de electrones libres entre √°tomos met√°licos", 
    "En la atracci√≥n de un n√∫cleo hacia los electrones de otro n√∫cleo"
  ];

  let opciones = [correcta, ...incorrectas];
  opciones = shuffle(opciones);

  return {
    mode: "single",
    prompt: "¬øEn qu√© consiste un enlace i√≥nico?",
    options: opciones,
    correct: [opciones.indexOf(correcta)],
    modelos: ["B","D"],
    repeatable: false
  };
}


function pregunta_teoria_de_los_electrones_17() {
  let correcta = "Covalente";
  let incorrectas = [
    "I√≥nico",
    "Met√°lico",
    "De Van der Waals"
  ];

  let opciones = [correcta, ...incorrectas];
  opciones = shuffle(opciones);

  return {
    mode: "single",
    prompt: "El hidr√≥geno molecular (H‚ÇÇ) y el ox√≠geno molecular (O‚ÇÇ) son mol√©culas con enlace...",
    options: opciones,
    correct: [opciones.indexOf(correcta)],
    modelos: ["B","D"],
    repeatable: false
  };
}


function pregunta_teoria_de_los_electrones_18() {
  let correcta = "Son s√≥lidos cristalinos, con altos puntos de fusi√≥n y conductores en disoluci√≥n o fundidos";
  let incorrectas = [
    "Son blandos, con bajos puntos de fusi√≥n y no conducen la electricidad", 
    "Son maleables, d√∫ctiles y buenos conductores en estado s√≥lido", 
    "Son gaseosos en condiciones normales y no forman redes cristalinas"
  ];

  let opciones = [correcta, ...incorrectas];
  opciones = shuffle(opciones);

  return {
    mode: "single",
    prompt: "¬øQu√© caracter√≠sticas f√≠sicas presentan los compuestos i√≥nicos?",
    options: opciones,
    correct: [opciones.indexOf(correcta)],
    modelos: ["B","D"],
    repeatable: false
  };
}


function pregunta_teoria_de_los_electrones_19() {
  let correcta = "Cationes met√°licos";
  let incorrectas = [
    "Aniones met√°licos",
    "Protones libres",
    "Electrones deslocalizados"
  ];

  let opciones = [correcta, ...incorrectas];
  opciones = shuffle(opciones);

  return {
    mode: "single",
    prompt: "¬øC√≥mo se denominan los pseudoiones positivos en el enlace met√°lico?",
    options: opciones,
    correct: [opciones.indexOf(correcta)],
    modelos: ["B","D"],
    repeatable: false
  };
}


function pregunta_teoria_de_los_electrones_20() {
  let correcta = "El equilibrio entre los cationes met√°licos y los electrones deslocalizados";
  let incorrectas = [
    "La repulsi√≥n entre los electrones deslocalizados", 
    "La atracci√≥n entre protones y neutrones",
    "La alternancia de iones positivos y negativos en una red cristalina"
  ];

  let opciones = [correcta, ...incorrectas];
  opciones = shuffle(opciones);

  return {
    mode: "single",
    prompt: "¬øQu√© mantiene la neutralidad electrost√°tica en el enlace met√°lico?",
    options: opciones,
    correct: [opciones.indexOf(correcta)],
    modelos: ["B","D"],
    repeatable: false
  };
}


function pregunta_teoria_de_los_electrones_21() {
  let correcta = "1, 8"; 
  let incorrectas = [
    "2, 6", // ‚ùå Incorrecta
    "3, 7", // ‚ùå Incorrecta
    "4, 2"  // ‚ùå Incorrecta
  ];

  let opciones = [correcta, ...incorrectas];
  opciones = shuffle(opciones);

  return {
    mode: "single",
    prompt: "Los elementos conductores ser√°n aquellos que tienen ... de valencia. Los aislantes ser√°n los que tienen ... electrones en su capa de valencia.",
    options: opciones,
    correct: [opciones.indexOf(correcta)],
    modelos: ["B","D"],
    repeatable: false
  };
}


function pregunta_teoria_de_los_electrones_22() {
  let correcta = "La plata (Ag)";
  let incorrectas = [
    "El cobre (Cu)",   // ‚ùå Incorrecta
    "El oro (Au)",     // ‚ùå Incorrecta
    "El aluminio (Al)" // ‚ùå Incorrecta
  ];

  let opciones = [correcta, ...incorrectas];
  opciones = shuffle(opciones);

  return {
    mode: "single",
    prompt: "¬øQu√© material es el mejor conductor de la electricidad?",
    options: opciones,
    correct: [opciones.indexOf(correcta)],
    modelos: ["B","D"],
    repeatable: false
  };
}


function pregunta_teoria_de_los_electrones_23() {
  let correcta = "Un material puro cuya conductividad depende de la temperatura y no de impurezas a√±adidas";
  let incorrectas = [
    "Un material puro cuya conductividad depende √∫nicamente de impurezas a√±adidas", // ‚ùå Extr√≠nseco
    "Un metal con baja resistividad el√©ctrica",                                    // ‚ùå Incorrecta
    "Un aislante que nunca puede conducir electricidad"                            // ‚ùå Incorrecta
  ];

  let opciones = [correcta, ...incorrectas];
  opciones = shuffle(opciones);

  return {
    mode: "single",
    prompt: "¬øQu√© es un semiconductor intr√≠nseco?",
    options: opciones,
    correct: [opciones.indexOf(correcta)],
    modelos: ["B","D"],
    repeatable: false
  };
}


function pregunta_teoria_de_los_electrones_24() {
  let correcta = "Tipo P";
  let incorrectas = [
    "Tipo N",   // ‚ùå Incorrecta
    "Tipo NP",  // ‚ùå Incorrecta
    "Intr√≠nseco" // ‚ùå Incorrecta
  ];

  let opciones = [correcta, ...incorrectas];
  opciones = shuffle(opciones);

  return {
    mode: "single",
    prompt: "Si se a√±ade galio (Ga) a un cristal de silicio (Si), se formar√° un semiconductor...",
    options: opciones,
    correct: [opciones.indexOf(correcta)],
    modelos: ["B","D"],
    repeatable: false
  };
}


function pregunta_teoria_de_los_electrones_25() {
  let correcta = "N"; 
  let incorrectas = [
    "P",            // ‚ùå Aceptoras, grupo III
    "NP",           // ‚ùå
    "Intr√≠nsecas"   // ‚ùå
  ];

  let opciones = [correcta, ...incorrectas];
  opciones = shuffle(opciones);

  return {
    mode: "single",
    prompt: "Un semiconductor donante est√° dopado con impurezas de tipo...",
    options: opciones,
    correct: [opciones.indexOf(correcta)],
    modelos: ["B","D"],
    repeatable: false
  };
}

















</script>


</script>
</body>
</html>
